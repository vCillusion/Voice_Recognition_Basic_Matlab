
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN">
<html xmlns:mwsh="http://www.mathworks.com/namespace/mcode/v1/syntaxhighlight.dtd">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
      <!--
This HTML is auto-generated from an M-file.
To make changes, update the M-file and republish this document.
      -->
      <title>voicerecognition</title>
      <meta name="generator" content="MATLAB 7.5">
      <meta name="date" content="2012-04-20">
      <meta name="m-file" content="voicerecognition"><style>

body {
  background-color: white;
  margin:10px;
}

h1 {
  color: #990000; 
  font-size: x-large;
}

h2 {
  color: #990000;
  font-size: medium;
}

/* Make the text shrink to fit narrow windows, but not stretch too far in 
wide windows. */ 
p,h1,h2,div.content div {
  max-width: 600px;
  /* Hack for IE6 */
  width: auto !important; width: 600px;
}

pre.codeinput {
  background: #EEEEEE;
  padding: 10px;
}
@media print {
  pre.codeinput {word-wrap:break-word; width:100%;}
} 

span.keyword {color: #0000FF}
span.comment {color: #228B22}
span.string {color: #A020F0}
span.untermstring {color: #B20000}
span.syscmd {color: #B28C00}

pre.codeoutput {
  color: #666666;
  padding: 10px;
}

pre.error {
  color: red;
}

p.footer {
  text-align: right;
  font-size: xx-small;
  font-weight: lighter;
  font-style: italic;
  color: gray;
}

  </style></head>
   <body>
      <div class="content">
         <h2>Contents</h2>
         <div>
            <ul>
               <li><a href="#1">Project: Voice Recognition and Identification system</a></li>
               <li><a href="#2">Main Function Voice Recognition</a></li>
               <li><a href="#3">1: Human speaker recognition</a></li>
               <li><a href="#4">2: Technical data of samples</a></li>
               <li><a href="#5">3: linear and logarithmic power spectrum plot</a></li>
               <li><a href="#6">4: Plots for different values for N</a></li>
               <li><a href="#7">5: Mel Space</a></li>
               <li><a href="#8">6: Modified spectrum</a></li>
               <li><a href="#9">7: 2D plot of accustic vectors</a></li>
               <li><a href="#10">8: Plot of the 2D trained VQ codewords</a></li>
               <li><a href="#11">9: Recognition rate of the computer</a></li>
               <li><a href="#12">9.1 Loading from Test Folder for Comparison</a></li>
               <li><a href="#13">9.2 Comparing one by one data from TRAIN FOLDER</a></li>
               <li><a href="#14">9.3 Note: Test with other speech files</a></li>
               <li><a href="#15">10: Voice Recognition by letting user enter into database and then compare</a></li>
               <li><a href="#16">10.1 Add a new sound from microphone</a></li>
               <li><a href="#17">10.2 Voice Recognition from microphone</a></li>
               <li><a href="#18">10.3 Database Info</a></li>
               <li><a href="#19">10.4 Delete database</a></li>
               <li><a href="#20">blockFrames Function</a></li>
               <li><a href="#21">MFCC Function</a></li>
               <li><a href="#22">VQLBG Vector quantization using the Linde-Buzo-Gray algorithm</a></li>
            </ul>
         </div>
         <h2>Project: Voice Recognition and Identification system<a name="1"></a></h2>
         <p>By  Mahima Garg, Omar Razi, Supriya Phutela, Vaibhav Kapoor, Varun Chopra</p><pre class="codeinput"><span class="comment">%--------------------------------------------------------------------------</span>
</pre><h2>Main Function Voice Recognition<a name="2"></a></h2><pre class="codeinput"><span class="keyword">function</span> []=voicerecognition()
<span class="comment">% For clear screen</span>
clc;
<span class="comment">% Ronaldo is a variable used to directly set the minimum distance for</span>
<span class="comment">% speech recognition.</span>
ronaldo=10;
<span class="comment">% Drogba is a variable used to directly set the maximum number of</span>
<span class="comment">% users stored in database</span>
drogba=8;
<span class="comment">% st, st1, st2, st3,  will be used for filenames related purposes reducing</span>
<span class="comment">% code redundancy.</span>
char <span class="string">st</span>; char <span class="string">st1</span>; char <span class="string">st2</span>; char <span class="string">st3</span>;
disp(<span class="string">'Project: Voice Recognition and Identification system'</span>);
disp(<span class="string">'By  Mahima Garg &amp; Omar Razi &amp; Supriya Phutela &amp; Vaibhav Kapoor &amp; Varun Chopra '</span>);
disp(<span class="string">' '</span>);
pause(0.5);
disp(<span class="string">'LOADING '</span>);
pause(1);
disp(<span class="string">'... '</span>);
pause(1);
disp(<span class="string">'... '</span>);
pause(1);
disp(<span class="string">'... '</span>);
pause(1);
disp(<span class="string">'... '</span>);
msgbox(<span class="string">'We have tried to make this project as user friendly as possible. We Hope you Appreciate and Enjoy !!!'</span>,<span class="string">'Voice Recognition and Identification System'</span>);

<span class="comment">% Preallocating array</span>
str = {8}; fstr = {8}; nbtr = {8};
ste = {8}; fste = {8}; nbte = {8};
ctr = {8}; dtr={8};
cte = {8}; dte={8};
data = {drogba,4};
code = {8};

<span class="keyword">for</span> i = 1:8

    <span class="comment">% Read audio data from train folder for performing operations</span>
    st=strcat(<span class="string">'train\s'</span>,num2str(i),<span class="string">'.wav'</span>);
    [s1 fs1 nb1]=wavread(st);
    str{i} = s1; fstr{i} = fs1; nbtr{i} = nb1;

    <span class="comment">% Read audio data from test folder for performing operations</span>
    st = strcat(<span class="string">'test\s'</span>,num2str(i),<span class="string">'.wav'</span>);
    [st1 fst1 nbt1] = wavread(st);
    ste{i} = st1; fste{i} = fst1; nbte{i} = nbt1;

    <span class="comment">% Compute MFCC of the audio data to be used in Speech Processing for Train</span>
    <span class="comment">% Folder</span>
    ctr{i} = mfcc(str{i},fstr{i});

    <span class="comment">% Compute MFCC of the audio data to be used in Speech Processing for Test</span>
    <span class="comment">% Folder</span>
    cte{i} = mfcc(ste{i},fste{i});

    <span class="comment">% Compute Vector Quantization of the audio data to be used in Speech</span>
    <span class="comment">% Processing for Train Folder</span>
    dtr{i} = vqlbg(ctr{i},16);

    <span class="comment">% Compute Vector Quantization of the audio data to be used in Speech</span>
    <span class="comment">% Processing for Test Folder</span>
    dte{i} = vqlbg(cte{i},16);
<span class="keyword">end</span>

<span class="comment">% For making Choice</span>
ch=0;
poss=11;
<span class="keyword">while</span> ch~=poss

    ch=menu(<span class="string">'Speaker Recognition System'</span>,<span class="string">'1: Human speaker recognition'</span>,<span class="keyword">...</span>
        <span class="string">'2: Technical data of samples'</span>,<span class="keyword">...</span>
        <span class="string">'3: Power Spectrum'</span>,<span class="string">'4: Power Spectrum with different M and N'</span>,<span class="keyword">...</span>
        <span class="string">'5: Mel-Spaced Filter Bank'</span>,<span class="keyword">...</span>
        <span class="string">'6: Spectrum before and after Mel-Frequency wrapping'</span>,<span class="keyword">...</span>
        <span class="string">'7: 2D plot of acoustic vectors'</span>,<span class="keyword">...</span>
        <span class="string">'8: Plot of VQ codewords'</span>,<span class="string">'9: Recognition rate of the computer'</span>,<span class="keyword">...</span>
        <span class="string">'10: Test with other speech files'</span>,<span class="string">'11: Exit'</span>);
    disp(<span class="string">'                                                                  '</span>);
    <span class="comment">%----------------------------------------------------------------------</span>
</pre><h2>1: Human speaker recognition<a name="3"></a></h2><pre class="codeinput">    <span class="comment">% Play each sound file in the TRAIN folder. Can you distinguish the voices</span>
    <span class="comment">% of those eight speakers? Now play each sound in the TEST folder in a</span>
    <span class="comment">% random order without looking at the file name (pretending that you do not</span>
    <span class="comment">% know the speaker) and try to identify the speaker using your knowledge of</span>
    <span class="comment">% their voices that you just learned from the TRAIN folder. This is exactly</span>
    <span class="comment">% what the computer will do in our system.</span>
    <span class="comment">% What is your (human performance) recognition rate ?</span>
    <span class="comment">% Record this result so that it can be used later to be compared with the</span>
    <span class="comment">% computer's performance of our system. Both of us seem to be unable to</span>
    <span class="comment">% recognise random people just by listening at their voice. Our success</span>
    <span class="comment">% rates for the provided samples were 1 person out of 8 each.</span>
    <span class="comment">%</span>
    <span class="comment">% However, for the samples we used in question 10, we were easily able to</span>
    <span class="comment">% recognise each speaker. This is probably because we knew all the persons.</span>
    <span class="comment">% We also realized that we did not identify speakers by the frequencies</span>
    <span class="comment">% they use to talk, but rather by other characteristics, like accent,</span>
    <span class="comment">% speed, etc.</span>

    <span class="keyword">if</span> ch==1
        disp(<span class="string">'&gt;  1: Human speaker recognition'</span>);
        disp(<span class="string">'Play each sound file in the TRAIN folder.'</span>);
        disp(<span class="string">'Can you distinguish the voices of those eight speakers?'</span>);
        disp(<span class="string">'Now play each sound in the TEST folder in a random order without looking at the file name '</span>);
        disp(<span class="string">'and try to identify the speaker using your knowledge of their voices that you have just heard,'</span>);
        disp(<span class="string">'from the TRAIN folder. This is exactly what the computer will do in our system.'</span>);
        disp(<span class="string">'                                                                                                  '</span>);
        disp(<span class="string">'                                                                                                   '</span>);
        disp(<span class="string">'All of us seem to be unable to recognise random people just by listening to their voice. '</span>);
        disp(<span class="string">'We also realize that we do not identify speakers by the frequencies with which they use to talk,  '</span>);
        disp(<span class="string">'but rather by other characteristics, like accent, speed, etc.'</span>);
        pause(1);

        ch2=0;
        <span class="keyword">while</span> ch2~=4
            ch2=menu(<span class="string">'Select Folder'</span>,<span class="string">'Train'</span>,<span class="string">'Test'</span>,<span class="string">'User'</span>,<span class="string">'Exit'</span>);

            <span class="keyword">if</span> ch2==1

                ch3=0;
                <span class="keyword">while</span> ch3~=9
                    ch3=menu(<span class="string">'Train :'</span>,<span class="string">'Signal 1'</span>,<span class="string">'Signal 2'</span>,<span class="string">'Signal 3'</span>,<span class="keyword">...</span>
                        <span class="string">'Signal 4'</span>,<span class="string">'Signal 5'</span>,<span class="string">'Signal 6'</span>,<span class="string">'Signal 7'</span>,<span class="string">'Signal 8'</span>,<span class="string">'Exit'</span>);
                    <span class="keyword">if</span> ch3~=9
                        p=audioplayer(str{ch3},fstr{ch3},nbtr{ch3});
                        play(p);
                    <span class="keyword">end</span>
                <span class="keyword">end</span>
            <span class="keyword">end</span>

            <span class="keyword">if</span> ch2==2

                ch3=0;
                <span class="keyword">while</span> ch3~=9
                    ch3=menu(<span class="string">'Test :'</span>,<span class="string">'Signal 1'</span>,<span class="string">'Signal 2'</span>,<span class="string">'Signal 3'</span>,<span class="keyword">...</span>
                        <span class="string">'Signal 4'</span>,<span class="string">'Signal 5'</span>,<span class="string">'Signal 6'</span>,<span class="string">'Signal 7'</span>,<span class="string">'Signal 8'</span>,<span class="string">'Exit'</span>);
                    <span class="keyword">if</span> ch3~=9
                        p=audioplayer(ste{ch3},fste{ch3},nbte{ch3});
                        play(p);
                    <span class="keyword">end</span>
                <span class="keyword">end</span>
                close <span class="string">all</span>;
            <span class="keyword">end</span>

            <span class="keyword">if</span> ch2==3

                <span class="keyword">if</span> (exist(<span class="string">'sound_database.dat'</span>,<span class="string">'file'</span>)==2)
                    load(<span class="string">'sound_database.dat'</span>,<span class="string">'-mat'</span>);

                    ch32=0;
                    <span class="keyword">while</span> ch32 ~=2
                        ch32=menu(<span class="string">'Database Information'</span>,<span class="string">'Database'</span>,<span class="string">'Exit'</span>);

                        <span class="keyword">if</span> ch32==1
                            st=strcat(<span class="string">'Sound Database has : #'</span>,num2str(sound_number),<span class="string">'words. Enter a database number : #'</span>);
                            prompt = {st};
                            dlg_title = <span class="string">'Database Information'</span>;
                            num_lines = 1;
                            def = {<span class="string">'1'</span>};
                            options.Resize=<span class="string">'on'</span>;
                            options.WindowStyle=<span class="string">'normal'</span>;
                            options.Interpreter=<span class="string">'tex'</span>;
                            an = inputdlg(prompt,dlg_title,num_lines,def);
                            an=cell2mat(an);
                            a = str2double(an);

                            <span class="keyword">if</span> (isempty(an))

                            <span class="keyword">else</span>

                                <span class="keyword">if</span> (a &lt;= sound_number)
                                    st=strcat(<span class="string">'u'</span>,num2str(an));
                                    [s fs nb]=wavread(st);
                                    p=audioplayer(s,fs,nb);
                                    play(p);

                                <span class="keyword">else</span>
                                    warndlg(<span class="string">'Invalid Word '</span>,<span class="string">'Warning'</span>);
                                <span class="keyword">end</span>
                            <span class="keyword">end</span>
                        <span class="keyword">end</span>
                        close <span class="string">all</span>;
                    <span class="keyword">end</span>

                <span class="keyword">else</span>
                    warndlg(<span class="string">'Database is empty.'</span>,<span class="string">' Warning '</span>)
                <span class="keyword">end</span>
            <span class="keyword">end</span>

        <span class="keyword">end</span>
    <span class="keyword">end</span>
    <span class="comment">%----------------------------------------------------------------------</span>
</pre><h2>2: Technical data of samples<a name="4"></a></h2><pre class="codeinput">    <span class="comment">% Read a sound file into Matlab. Check it by playing the sound file in</span>
    <span class="comment">% Matlab using the function: sound. What is the sampling rate? What is the</span>
    <span class="comment">% highest frequency that the recorded sound can capture with fidelity? With</span>
    <span class="comment">% that sampling rate, how many msecs of actual speech are contained in a</span>
    <span class="comment">% block of 256 samples?</span>
    <span class="comment">%</span>
    <span class="comment">% Plot the signal to view it in the time domain. It should be obvious that</span>
    <span class="comment">% the raw data in the time domain has a great amount of data and for this</span>
    <span class="comment">% reason it is difficult to analyse the voice characteristic. So the</span>
    <span class="comment">% purpose of this step (speech feature extraction) should be clear now!</span>
    <span class="comment">%</span>
    <span class="comment">% Intermediate steps that follows:</span>
    <span class="comment">%</span>
    <span class="comment">% Frames blocking phase</span>
    <span class="comment">% To obtain a matrix M containing all the frames, we used the following script:</span>
    <span class="comment">% That way we obtain the 256 x 129 matrix M.</span>
    <span class="comment">%</span>
    <span class="comment">% Windowing phase</span>
    <span class="comment">% We create the Hamming matrix and transform the matrix M into the new</span>
    <span class="comment">% matrix M2, where the column vectors of M2 are the original frame vectors</span>
    <span class="comment">% transformed by the Hamming filter.</span>
    <span class="comment">%</span>
    <span class="comment">% FFT Phase</span>
    <span class="comment">% We create a new matrix M3 where the column vectors are the FFTs of the</span>
    <span class="comment">% column vectors of M2.</span>

    <span class="keyword">if</span> ch==2
        disp(<span class="string">'&gt; 2: Technical data of samples'</span>);

        ch23=0;
        <span class="keyword">while</span> ch23~=4
            ch23=menu(<span class="string">'Select Folder'</span>,<span class="string">'Train'</span>,<span class="string">'Test'</span>,<span class="string">'User'</span>,<span class="string">'Exit'</span>);

            <span class="keyword">if</span> ch23==1
                poss2=9;
                ch2=0;
                <span class="keyword">while</span> ch2~=poss2
                    ch2=menu(<span class="string">'Technical data of samples for :'</span>,<span class="string">'Signal 1'</span>,<span class="string">'Signal 2'</span>,<span class="string">'Signal 3'</span>,<span class="keyword">...</span>
                        <span class="string">'Signal 4'</span>,<span class="string">'Signal 5'</span>,<span class="string">'Signal 6'</span>,<span class="string">'Signal 7'</span>,<span class="string">'Signal 8'</span>,<span class="string">'Exit'</span>);
                    <span class="keyword">if</span> ch2~=9
                        t = 0:1/fstr{ch2}:(length(str{ch2}) - 1)/fstr{ch2};
                        plot(t, str{ch2}), axis([0, (length(str{ch2}) - 1)/fstr{ch2} -0.4 0.5]);
                        st=sprintf(<span class="string">'Plot of signal s%d.wav'</span>,ch2);
                        title(st);
                        xlabel(<span class="string">'Time [s]'</span>);
                        ylabel(<span class="string">'Amplitude (normalized)'</span>)
                    <span class="keyword">end</span>
                <span class="keyword">end</span>
                close <span class="string">all</span>
            <span class="keyword">end</span>

            <span class="keyword">if</span> ch23==2
                poss2=9;
                ch2=0;
                <span class="keyword">while</span> ch2~=poss2
                    ch2=menu(<span class="string">'Technical data of samples for :'</span>,<span class="string">'Signal 1'</span>,<span class="string">'Signal 2'</span>,<span class="string">'Signal 3'</span>,<span class="keyword">...</span>
                        <span class="string">'Signal 4'</span>,<span class="string">'Signal 5'</span>,<span class="string">'Signal 6'</span>,<span class="string">'Signal 7'</span>,<span class="string">'Signal 8'</span>,<span class="string">'Exit'</span>);
                    <span class="keyword">if</span> ch2~=9
                        t = 0:1/fste{ch2}:(length(ste{ch2}) - 1)/fste{ch2};
                        plot(t, ste{ch2}), axis([0, (length(ste{ch2}) - 1)/fste{ch2} -0.4 0.5]);
                        st=sprintf(<span class="string">'Plot of signal s%d.wav'</span>,ch2);
                        title(st);
                        xlabel(<span class="string">'Time [s]'</span>);
                        ylabel(<span class="string">'Amplitude (normalized)'</span>)
                    <span class="keyword">end</span>
                <span class="keyword">end</span>
                close <span class="string">all</span>
            <span class="keyword">end</span>

            <span class="keyword">if</span> ch23==3

                <span class="keyword">if</span> (exist(<span class="string">'sound_database.dat'</span>,<span class="string">'file'</span>)==2)
                    load(<span class="string">'sound_database.dat'</span>,<span class="string">'-mat'</span>);

                    ch32=0;
                    <span class="keyword">while</span> ch32 ~=2
                        ch32=menu(<span class="string">'Database Information'</span>,<span class="string">'Database'</span>,<span class="string">'Exit'</span>);

                        <span class="keyword">if</span> ch32==1
                            st=strcat(<span class="string">'Sound Database has : #'</span>,num2str(sound_number),<span class="string">'words. Enter a database number : #'</span>);
                            prompt = {st};
                            dlg_title = <span class="string">'Database Information'</span>;
                            num_lines = 1;
                            def = {<span class="string">'1'</span>};
                            options.Resize=<span class="string">'on'</span>;
                            options.WindowStyle=<span class="string">'normal'</span>;
                            options.Interpreter=<span class="string">'tex'</span>;
                            an = inputdlg(prompt,dlg_title,num_lines,def);
                            an=cell2mat(an);
                            a = str2double(an);

                            <span class="keyword">if</span> (isempty(an))

                            <span class="keyword">else</span>

                                <span class="keyword">if</span> (a &lt;= sound_number)
                                    st=strcat(<span class="string">'u'</span>,num2str(an));
                                    [s fs]=wavread(st);
                                    t = 0:1/fs:(length(s) - 1)/fs;
                                    plot(t, s), axis([0, (length(s) - 1)/fs -0.4 0.5]);
                                    st=sprintf(<span class="string">'Plot of signal %s'</span>,st);
                                    title(st);
                                    xlabel(<span class="string">'Time [s]'</span>);
                                    ylabel(<span class="string">'Amplitude (normalized)'</span>)

                                <span class="keyword">else</span>
                                    warndlg(<span class="string">'Invalid Word '</span>,<span class="string">'Warning'</span>);
                                <span class="keyword">end</span>
                            <span class="keyword">end</span>

                        <span class="keyword">end</span>
                    <span class="keyword">end</span>
                    close <span class="string">all</span>;

                <span class="keyword">else</span>
                    warndlg(<span class="string">'Database is empty.'</span>,<span class="string">' Warning '</span>)
                <span class="keyword">end</span>
            <span class="keyword">end</span>

        <span class="keyword">end</span>
    <span class="keyword">end</span>
    <span class="comment">%----------------------------------------------------------------------</span>
</pre><h2>3: linear and logarithmic power spectrum plot<a name="5"></a></h2><pre class="codeinput">    <span class="comment">% After successfully running the preceding process, what is the</span>
    <span class="comment">% interpretation you can make of the result obtained? Compute the power</span>
    <span class="comment">% spectrum and plot it out using the imagesc command. Note that it is</span>
    <span class="comment">% better to view the power spectrum on the log scale. Locate the region in</span>
    <span class="comment">% the plot that contains most of the energy. Translate this location into</span>
    <span class="comment">% the actual ranges in time (msec) and frequency (in Hz) of the input</span>
    <span class="comment">% speech signal.</span>
    <span class="comment">%</span>
    <span class="comment">% As stated before, the columns matrix M3 contain the frames of the</span>
    <span class="comment">% original signal, filtered by the Hamming filter and transformed with the</span>
    <span class="comment">% FFT. The elements of M3 are complex numbers and symmetrical because FFT</span>
    <span class="comment">% was used to transform the data.</span>
    <span class="comment">% Each column in M3 is a power spectrum representation of the original signal.</span>
    <span class="comment">% To plot the power spectrum, we take the absolute values of the matrix</span>
    <span class="comment">% elements. Since the spectrum is symmetric, we only plot half of it. Note</span>
    <span class="comment">% that we plot simultaneously with the linear and the logarithmic spectrum</span>
    <span class="comment">% scale.</span>
    <span class="comment">%</span>
    <span class="comment">% The result obtained is the plot in this section.</span>
    <span class="comment">% In this plot, the areas containing the highest level of energy are</span>
    <span class="comment">% displayed in red. As we can see on the plot, the red area is located</span>
    <span class="comment">% between 0.3 and 0.7 seconds. The plot also shows that most of the energy</span>
    <span class="comment">% is concentrated in the lower frequencies (between 50 Hz and 1 kHz).</span>

    <span class="keyword">if</span> ch==3
        M = 100;
        N = 256;
        disp(<span class="string">'&gt; 3: Power Spectrum Plot'</span>);
        disp(<span class="string">'                                                      '</span>);
        disp(<span class="string">'&gt;Linear and Logarithmic spectrum plot'</span>);

        ch23=0;
        <span class="keyword">while</span> ch23~=4
            ch23=menu(<span class="string">'Select Folder'</span>,<span class="string">'Train'</span>,<span class="string">'Test'</span>,<span class="string">'User'</span>,<span class="string">'Exit'</span>);

            <span class="keyword">if</span> ch23==1
                poss3=9;
                ch3=0;
                <span class="keyword">while</span> ch3~=poss3
                    ch3=menu(<span class="string">'Linear and Logarithmic Power Spectrum Plot for : '</span>,<span class="string">'Signal 1'</span>,<span class="string">'Signal 2'</span>,<span class="string">'Signal 3'</span>,<span class="keyword">...</span>
                        <span class="string">'Signal 4'</span>,<span class="string">'Signal 5'</span>,<span class="string">'Signal 6'</span>,<span class="string">'Signal 7'</span>,<span class="string">'Signal 8'</span>,<span class="string">'Exit'</span>);
                    <span class="keyword">if</span> ch3~=9
                        <span class="comment">% 3 (linear)</span>
                        frames = blockFrames(str{ch3}, fstr{ch3}, M, N);
                        t = N / 2;
                        tm = length(str{ch3}) / fstr{ch3};
                        subplot(121);
                        imagesc([0 tm], [0 fstr{ch3}/2], abs(frames(1:t, :)).^2), axis <span class="string">xy</span>;
                        title(<span class="string">'Power Spectrum (M = 100, N = 256)'</span>);
                        xlabel(<span class="string">'Time [s]'</span>);
                        ylabel(<span class="string">'Frequency [Hz]'</span>);
                        colorbar;
                        <span class="comment">% 3 (logarithmic)</span>
                        subplot(122);
                        imagesc([0 tm], [0 fstr{ch3}/2], 20 * log10(abs(frames(1:t, :)).^2)), axis <span class="string">xy</span>;
                        title(<span class="string">'Logarithmic Power Spectrum (M = 100, N = 256)'</span>);
                        xlabel(<span class="string">'Time [s]'</span>);
                        ylabel(<span class="string">'Frequency [Hz]'</span>);
                        colorbar;
                        <span class="comment">% D=get(gcf,'Position');</span>
                        <span class="comment">% set(gcf,'Position',round([D(1)*.5 D(2)*.5 D(3)*2 D(4)*1.3]))</span>
                    <span class="keyword">end</span>
                <span class="keyword">end</span>
                close <span class="string">all</span>
            <span class="keyword">end</span>

            <span class="keyword">if</span> ch23==2
                poss3=9;
                ch3=0;
                <span class="keyword">while</span> ch3~=poss3
                    ch3=menu(<span class="string">'Linear and Logarithmic Power Spectrum Plot for : '</span>,<span class="string">'Signal 1'</span>,<span class="string">'Signal 2'</span>,<span class="string">'Signal 3'</span>,<span class="keyword">...</span>
                        <span class="string">'Signal 4'</span>,<span class="string">'Signal 5'</span>,<span class="string">'Signal 6'</span>,<span class="string">'Signal 7'</span>,<span class="string">'Signal 8'</span>,<span class="string">'Exit'</span>);
                    <span class="keyword">if</span> ch3~=9
                        <span class="comment">% 3 (linear)</span>
                        frames = blockFrames(ste{ch3}, fste{ch3}, M, N);
                        t = N / 2;
                        tm = length(ste{ch3}) / fste{ch3};
                        subplot(121);
                        imagesc([0 tm], [0 fste{ch3}/2], abs(frames(1:t, :)).^2), axis <span class="string">xy</span>;
                        title(<span class="string">'Power Spectrum (M = 100, N = 256)'</span>);
                        xlabel(<span class="string">'Time [s]'</span>);
                        ylabel(<span class="string">'Frequency [Hz]'</span>);
                        colorbar;
                        <span class="comment">% 3 (logarithmic)</span>
                        subplot(122);
                        imagesc([0 tm], [0 fste{ch3}/2], 20 * log10(abs(frames(1:t, :)).^2)), axis <span class="string">xy</span>;
                        title(<span class="string">'Logarithmic Power Spectrum (M = 100, N = 256)'</span>);
                        xlabel(<span class="string">'Time [s]'</span>);
                        ylabel(<span class="string">'Frequency [Hz]'</span>);
                        colorbar;
                        <span class="comment">% D=get(gcf,'Position');</span>
                        <span class="comment">% set(gcf,'Position',round([D(1)*.5 D(2)*.5 D(3)*2 D(4)*1.3]))</span>
                    <span class="keyword">end</span>
                <span class="keyword">end</span>
                close <span class="string">all</span>;
            <span class="keyword">end</span>

            <span class="keyword">if</span> ch23==3

                <span class="keyword">if</span> (exist(<span class="string">'sound_database.dat'</span>,<span class="string">'file'</span>)==2)
                    load(<span class="string">'sound_database.dat'</span>,<span class="string">'-mat'</span>);

                    ch32=0;
                    <span class="keyword">while</span> ch32 ~=2
                        ch32=menu(<span class="string">'Database Information'</span>,<span class="string">'Database'</span>,<span class="string">'Exit'</span>);

                        <span class="keyword">if</span> ch32==1
                            st=strcat(<span class="string">'Sound Database has : #'</span>,num2str(sound_number),<span class="string">'words. Enter a database number : #'</span>);
                            prompt = {st};
                            dlg_title = <span class="string">'Database Information'</span>;
                            num_lines = 1;
                            def = {<span class="string">'1'</span>};
                            options.Resize=<span class="string">'on'</span>;
                            options.WindowStyle=<span class="string">'normal'</span>;
                            options.Interpreter=<span class="string">'tex'</span>;
                            an = inputdlg(prompt,dlg_title,num_lines,def);
                            an=cell2mat(an);
                            a = str2double(an);

                            <span class="keyword">if</span> (isempty(an))

                            <span class="keyword">else</span>

                                <span class="keyword">if</span> (a &lt;= sound_number)
                                st=strcat(<span class="string">'u'</span>,num2str(an));
                                [s fs]=wavread(st);
                                frames = blockFrames(s, fs, M, N);
                                t = N / 2;
                                tm = length(s) / fs;
                                subplot(121);
                                imagesc([0 tm], [0 fs/2], abs(frames(1:t, :)).^2), axis <span class="string">xy</span>;
                                title(<span class="string">'Power Spectrum (M = 100, N = 256)'</span>);
                                xlabel(<span class="string">'Time [s]'</span>);
                                ylabel(<span class="string">'Frequency [Hz]'</span>);
                                colorbar;
                                <span class="comment">%Question 3 (logarithmic)</span>
                                subplot(122);
                                imagesc([0 tm], [0 fs/2], 20 * log10(abs(frames(1:t, :)).^2)), axis <span class="string">xy</span>;
                                title(<span class="string">'Logarithmic Power Spectrum (M = 100, N = 256)'</span>);
                                xlabel(<span class="string">'Time [s]'</span>);
                                ylabel(<span class="string">'Frequency [Hz]'</span>);
                                colorbar;

                                <span class="keyword">else</span>
                                    warndlg(<span class="string">'Invalid Word '</span>,<span class="string">'Warning'</span>);
                                <span class="keyword">end</span>
                            <span class="keyword">end</span>
                        <span class="keyword">end</span>
                    <span class="keyword">end</span>
                    close <span class="string">all</span>;

                <span class="keyword">else</span>
                    warndlg(<span class="string">'Database is empty.'</span>,<span class="string">' Warning '</span>)
                <span class="keyword">end</span>
            <span class="keyword">end</span>

        <span class="keyword">end</span>
    <span class="keyword">end</span>
    <span class="comment">%----------------------------------------------------------------------</span>
</pre><h2>4: Plots for different values for N<a name="6"></a></h2><pre class="codeinput">    <span class="comment">% Compute and plot the power spectrum of a speech file using different</span>
    <span class="comment">% frames sizes: for example N = 128, 256 and 512. In each case, set the</span>
    <span class="comment">% frame increement M to be about N/3. Can you describe and explain the</span>
    <span class="comment">% differences between these spectra ?</span>
    <span class="comment">%</span>
    <span class="comment">% For N = 128 we have a high resolution of time. Furthermore each frame</span>
    <span class="comment">% lasts a very short period of time. This result shows that the signal for</span>
    <span class="comment">% a frame doesn't change its nature (i.e. it will be for the same vowel or</span>
    <span class="comment">% consonant). On the other hand, there are only 65 distinct frequencies</span>
    <span class="comment">% samples. This means that we have a poor frequency resolution.</span>
    <span class="comment">%</span>
    <span class="comment">% For N = 256 we have a compro mise between the resolution in time and the</span>
    <span class="comment">% frequency resolution.</span>
    <span class="comment">% For N = 512 we have an excellent frequency resolution (256 different</span>
    <span class="comment">% values) but there are lesser frames, meaning that the resolution in</span>
    <span class="comment">% time is strongly reduced.</span>
    <span class="comment">% It seems that a value of 256 for N is an acceptable compromise.</span>
    <span class="comment">% Furthermore the number of frames is relatively small, which will reduce</span>
    <span class="comment">% computing time.</span>

    <span class="keyword">if</span> ch==4
        disp(<span class="string">'&gt;  4: Plots for different values for M and N'</span>);
        lN = [128 256 512];

        ch23=0;
        <span class="keyword">while</span> ch23~=4
            ch23=menu(<span class="string">'Select Folder'</span>,<span class="string">'Train'</span>,<span class="string">'Test'</span>,<span class="string">'User'</span>,<span class="string">'Exit'</span>);

            <span class="keyword">if</span> ch23==1
                poss3=9;
                ch3=0;
                <span class="keyword">while</span> ch3~=poss3
                    ch3=menu(<span class="string">'Plots for different values of M and N for :'</span>,<span class="string">'Signal 1'</span>,<span class="string">'Signal 2'</span>,<span class="string">'Signal 3'</span>,<span class="keyword">...</span>
                        <span class="string">'Signal 4'</span>,<span class="string">'Signal 5'</span>,<span class="string">'Signal 6'</span>,<span class="string">'Signal 7'</span>,<span class="string">'Signal 8'</span>,<span class="string">'Exit'</span>);
                    <span class="keyword">if</span> ch3~=9
                        u=220;
                        <span class="keyword">for</span> i = 1:length(lN)
                            N = lN(i);
                            M = round(N / 3);
                            frames = blockFrames(str{ch3}, fstr{ch3}, M, N);
                            t = N / 2;
                            tm = length(str{ch3}) / fstr{ch3};
                            temp = size(frames);
                            nbframes = temp(2);
                            u=u+1;
                            subplot(u)
                            imagesc([0 tm], [0 fstr{ch3}/2], 20 * log10(abs(frames(1:t, :)).^2)), axis <span class="string">xy</span>;
                            title(sprintf(<span class="string">'Power Spectrum (M = %i, N = %i, frames = %i)'</span>, M, N, nbframes));
                            xlabel(<span class="string">'Time [s]'</span>);
                            ylabel(<span class="string">'Frequency [Hz]'</span>);
                            colorbar
                        <span class="keyword">end</span>
                        <span class="comment">% D=get(gcf,'Position');</span>
                        <span class="comment">% set(gcf,'Position',round([D(1)*.5 D(2)*.5 D(3)*1.5 D(4)*1.5]))</span>
                    <span class="keyword">end</span>
                <span class="keyword">end</span>
                close <span class="string">all</span>
            <span class="keyword">end</span>

            <span class="keyword">if</span> ch23==2
                poss3=9;
                ch3=0;
                <span class="keyword">while</span> ch3~=poss3
                    ch3=menu(<span class="string">'Plots for different values of M and N for :'</span>,<span class="string">'Signal 1'</span>,<span class="string">'Signal 2'</span>,<span class="string">'Signal 3'</span>,<span class="keyword">...</span>
                        <span class="string">'Signal 4'</span>,<span class="string">'Signal 5'</span>,<span class="string">'Signal 6'</span>,<span class="string">'Signal 7'</span>,<span class="string">'Signal 8'</span>,<span class="string">'Exit'</span>);
                    <span class="keyword">if</span> ch3~=9
                        u=220;
                        <span class="keyword">for</span> i = 1:length(lN)
                            N = lN(i);
                            M = round(N / 3);
                            frames = blockFrames(ste{ch3}, fste{ch3}, M, N);
                            t = N / 2;
                            tm = length(ste{ch3}) / fste{ch3};
                            temp = size(frames);
                            nbframes = temp(2);
                            u=u+1;
                            subplot(u)
                            imagesc([0 tm], [0 fste{ch3}/2], 20 * log10(abs(frames(1:t, :)).^2)), axis <span class="string">xy</span>;
                            title(sprintf(<span class="string">'Power Spectrum (M = %i, N = %i, frames = %i)'</span>, M, N, nbframes));
                            xlabel(<span class="string">'Time [s]'</span>);
                            ylabel(<span class="string">'Frequency [Hz]'</span>);
                            colorbar
                        <span class="keyword">end</span>
                        <span class="comment">% D=get(gcf,'Position');</span>
                        <span class="comment">% set(gcf,'Position',round([D(1)*.5 D(2)*.5 D(3)*1.5 D(4)*1.5]))</span>
                    <span class="keyword">end</span>
                <span class="keyword">end</span>
                close <span class="string">all</span>;
            <span class="keyword">end</span>

            <span class="keyword">if</span> ch23==3

                <span class="keyword">if</span> (exist(<span class="string">'sound_database.dat'</span>,<span class="string">'file'</span>)==2)
                    load(<span class="string">'sound_database.dat'</span>,<span class="string">'-mat'</span>);

                    ch32=0;
                    <span class="keyword">while</span> ch32 ~=2
                        ch32=menu(<span class="string">'Database Information'</span>,<span class="string">'Database'</span>,<span class="string">'Exit'</span>);

                        <span class="keyword">if</span> ch32==1
                            st=strcat(<span class="string">'Sound Database has : #'</span>,num2str(sound_number),<span class="string">'words. Enter a database number : #'</span>);
                            prompt = {st};
                            dlg_title = <span class="string">'Database Information'</span>;
                            num_lines = 1;
                            def = {<span class="string">'1'</span>};
                            options.Resize=<span class="string">'on'</span>;
                            options.WindowStyle=<span class="string">'normal'</span>;
                            options.Interpreter=<span class="string">'tex'</span>;
                            an = inputdlg(prompt,dlg_title,num_lines,def);
                            an=cell2mat(an);
                            a = str2double(an);

                            <span class="keyword">if</span> (isempty(an))

                            <span class="keyword">else</span>

                                <span class="keyword">if</span> (a &lt;= sound_number)
                                    st=strcat(<span class="string">'u'</span>,num2str(an));
                                    [s fs]=wavread(st);
                                    u=220;
                                    <span class="keyword">for</span> i = 1:length(lN)
                                        N = lN(i);
                                        M = round(N / 3);
                                        frames = blockFrames(s, fs, M, N);
                                        t = N / 2;
                                        tm = length(s) / fs;
                                        temp = size(frames);
                                        nbframes = temp(2);
                                        u=u+1;
                                        subplot(u)
                                        imagesc([0 tm], [0 fs/2], 20 * log10(abs(frames(1:t, :)).^2)), axis <span class="string">xy</span>;
                                        title(sprintf(<span class="string">'Power Spectrum (M = %i, N = %i, frames = %i)'</span>, M, N, nbframes));
                                        xlabel(<span class="string">'Time [s]'</span>);
                                        ylabel(<span class="string">'Frequency [Hz]'</span>);
                                        colorbar
                                    <span class="keyword">end</span>
                                <span class="keyword">else</span>
                                    warndlg(<span class="string">'Invalid Word '</span>,<span class="string">'Warning'</span>);
                                <span class="keyword">end</span>
                            <span class="keyword">end</span>
                        <span class="keyword">end</span>
                     <span class="keyword">end</span>
                    close <span class="string">all</span>;

                <span class="keyword">else</span>
                    warndlg(<span class="string">'Database is empty.'</span>,<span class="string">' Warning '</span>)
                <span class="keyword">end</span>
            <span class="keyword">end</span>
        <span class="keyword">end</span>
    <span class="keyword">end</span>
    <span class="comment">%----------------------------------------------------------------------</span>
</pre><h2>5: Mel Space<a name="7"></a></h2><pre class="codeinput">    <span class="comment">% Type 'help melfb' at the Matlab prompt for more information about this</span>
    <span class="comment">% function. Follow the guidelines to plot out the mel-spaced filter bank.</span>
    <span class="comment">% What is the behaviour of this filter bank? Compare it with the</span>
    <span class="comment">% theoretical part. To plot this filter bank, we use melfb command.</span>
    <span class="comment">% This filter bank behaves like a succession of histograms on the spectrum.</span>
    <span class="comment">% Each filter of the filter bank has a triangular frequency response. It</span>
    <span class="comment">% quantifies the zone of the frequency spectrum.</span>
    <span class="comment">%</span>
    <span class="comment">% The filter bank is used to transform the spectrum of a signal into a</span>
    <span class="comment">% representation which reflects more closely the behaviour of the human</span>
    <span class="comment">% ear. As the human ear (or the associated neurons) favours low frequencies</span>
    <span class="comment">% for analysing speech, the filters are denser for the lower frequencies.</span>
    <span class="comment">% To mimic the human ear, the filters are linearly distributed for low</span>
    <span class="comment">% frequencies (below 1kHz). For higher frequencies (above 1 kHz) the</span>
    <span class="comment">% distribution of the filters is logarithmic.</span>
    <span class="comment">% However we calculated 20 filters (instead of 12).</span>

    <span class="keyword">if</span> ch==5
        disp(<span class="string">'&gt; 5: Mel Space'</span>);
        disp(<span class="string">'                                                                 '</span>);
        disp(<span class="string">'Mel Space is function of sampling rate and since all signals '</span>);
        disp(<span class="string">'are recorded at same sampling rate so they have same Mel Space.'</span>);

        ch23=0;
        <span class="keyword">while</span> ch23~=4
            ch23=menu(<span class="string">'Select Folder'</span>,<span class="string">'Train'</span>,<span class="string">'Test'</span>,<span class="string">'User'</span>,<span class="string">'Exit'</span>);

            <span class="keyword">if</span> ch23==1
                poss3=9;
                ch3=0;
                <span class="keyword">while</span> ch3~=poss3
                    ch3=menu(<span class="string">'Mel Space for :'</span>,<span class="string">'Signal 1'</span>,<span class="string">'Signal 2'</span>,<span class="string">'Signal 3'</span>,<span class="keyword">...</span>
                        <span class="string">'Signal 4'</span>,<span class="string">'Signal 5'</span>,<span class="string">'Signal 6'</span>,<span class="string">'Signal 7'</span>,<span class="string">'Signal 8'</span>,<span class="string">'Exit'</span>);
                    <span class="keyword">if</span> ch3~=9
                        plot(linspace(0, (fstr{ch3}/2), 129), (melfb(20, 256, fstr{ch3})));
                        title(<span class="string">'Mel-Spaced Filterbank'</span>);
                        xlabel(<span class="string">'Frequency [Hz]'</span>);
                    <span class="keyword">end</span>
                <span class="keyword">end</span>
                close <span class="string">all</span>
            <span class="keyword">end</span>


            <span class="keyword">if</span> ch23==2
                poss3=9;
                ch3=0;
                <span class="keyword">while</span> ch3~=poss3
                    ch3=menu(<span class="string">'Mel Space for :'</span>,<span class="string">'Signal 1'</span>,<span class="string">'Signal 2'</span>,<span class="string">'Signal 3'</span>,<span class="keyword">...</span>
                        <span class="string">'Signal 4'</span>,<span class="string">'Signal 5'</span>,<span class="string">'Signal 6'</span>,<span class="string">'Signal 7'</span>,<span class="string">'Signal 8'</span>,<span class="string">'Exit'</span>);
                    <span class="keyword">if</span> ch3~=9
                        plot(linspace(0, (fste{ch3}/2), 129), (melfb(20, 256, fste{ch3})));
                        title(<span class="string">'Mel-Spaced Filterbank'</span>);
                        xlabel(<span class="string">'Frequency [Hz]'</span>);
                    <span class="keyword">end</span>
                <span class="keyword">end</span>
                close <span class="string">all</span>;
            <span class="keyword">end</span>

            <span class="keyword">if</span> ch23==3

                <span class="keyword">if</span> (exist(<span class="string">'sound_database.dat'</span>,<span class="string">'file'</span>)==2)
                    load(<span class="string">'sound_database.dat'</span>,<span class="string">'-mat'</span>);

                    ch32=0;
                    <span class="keyword">while</span> ch32 ~=2
                        ch32=menu(<span class="string">'Database Information'</span>,<span class="string">'Database'</span>,<span class="string">'Exit'</span>);

                        <span class="keyword">if</span> ch32==1
                            st=strcat(<span class="string">'Sound Database has : #'</span>,num2str(sound_number),<span class="string">'words. Enter a database number : #'</span>);
                            prompt = {st};
                            dlg_title = <span class="string">'Database Information'</span>;
                            num_lines = 1;
                            def = {<span class="string">'1'</span>};
                            options.Resize=<span class="string">'on'</span>;
                            options.WindowStyle=<span class="string">'normal'</span>;
                            options.Interpreter=<span class="string">'tex'</span>;
                            an = inputdlg(prompt,dlg_title,num_lines,def);
                            an=cell2mat(an);
                            a=str2double(an);

                            <span class="keyword">if</span> (isempty(an))

                            <span class="keyword">else</span>

                                <span class="keyword">if</span> (a &lt;= sound_number)
                                    st=strcat(<span class="string">'u'</span>,num2str(an));
                                    [s fs]=wavread(st);
                                    plot(linspace(0, (fs/2), 129), (melfb(20, 256, fs)));
                                    title(<span class="string">'Mel-Spaced Filterbank'</span>);
                                    xlabel(<span class="string">'Frequency [Hz]'</span>);
                                <span class="keyword">else</span>
                                    warndlg(<span class="string">'Invalid Word '</span>,<span class="string">'Warning'</span>);
                                <span class="keyword">end</span>
                            <span class="keyword">end</span>
                        <span class="keyword">end</span>
                    <span class="keyword">end</span>
                    close <span class="string">all</span>;

                <span class="keyword">else</span>
                    warndlg(<span class="string">'Database is empty.'</span>,<span class="string">' Warning '</span>)
                <span class="keyword">end</span>
            <span class="keyword">end</span>

        <span class="keyword">end</span>
    <span class="keyword">end</span>
    <span class="comment">%----------------------------------------------------------------------</span>
</pre><h2>6: Modified spectrum<a name="8"></a></h2><pre class="codeinput">    <span class="comment">% Compute and plot the spectrum of a speech file before and after the mel-</span>
    <span class="comment">% frequency wrapping step. Describe and explain the impact of the melfb</span>
    <span class="comment">% program.</span>
    <span class="comment">%</span>
    <span class="comment">% As we can see in the first plot, most of the information is contained in</span>
    <span class="comment">% the lower frequencies. This information has been extracted and amplified</span>
    <span class="comment">% in the second plot. The second plot therefore shows the main</span>
    <span class="comment">% characteristics of the speech signal.</span>
    <span class="comment">% Note that the transformation produced an acoustic vector of 20 dimensions.</span>

    <span class="keyword">if</span> ch==6
        disp(<span class="string">'&gt; 6: Modified spectrum'</span>);
        disp(<span class="string">'                                                              '</span>);
        disp(<span class="string">'Spectrum before and after Mel-Frequency wrapping'</span>);
        M = 100;
        N = 256;
        n2 = 1 + floor(N / 2);

        ch23=0;
        <span class="keyword">while</span> ch23~=4
            ch23=menu(<span class="string">'Select Folder'</span>,<span class="string">'Train'</span>,<span class="string">'Test'</span>,<span class="string">'User'</span>,<span class="string">'Exit'</span>);

            <span class="keyword">if</span> ch23==1
                poss3=9;
                ch3=0;
                <span class="keyword">while</span> ch3~=poss3
                    ch3=menu(<span class="string">'Mel Space for :'</span>,<span class="string">'Signal 1'</span>,<span class="string">'Signal 2'</span>,<span class="string">'Signal 3'</span>,<span class="keyword">...</span>
                        <span class="string">'Signal 4'</span>,<span class="string">'Signal 5'</span>,<span class="string">'Signal 6'</span>,<span class="string">'Signal 7'</span>,<span class="string">'Signal 8'</span>,<span class="string">'Exit'</span>);
                    <span class="keyword">if</span> ch3~=9
                        frames = blockFrames(str{ch3}, fstr{ch3}, M, N);
                        m = melfb(20, N, fstr{ch3});
                        z = m * abs(frames(1:n2, :)).^2;
                        tm = length(str{ch3}) / fstr{ch3};
                        subplot(121)
                        imagesc([0 tm], [0 fstr{ch3}/2], abs(frames(1:n2, :)).^2), axis <span class="string">xy</span>;
                        title(<span class="string">'Power Spectrum unmodified'</span>);
                        xlabel(<span class="string">'Time [s]'</span>);
                        ylabel(<span class="string">'Frequency [Hz]'</span>);
                        colorbar;
                        subplot(122)
                        imagesc([0 tm], [0 20], z), axis <span class="string">xy</span>;
                        title(<span class="string">'Power Spectrum modified through Mel Cepstrum filter'</span>);
                        xlabel(<span class="string">'Time [s]'</span>);
                        ylabel(<span class="string">'Number of Filter in Filter Bank'</span>);
                        <span class="comment">% colorbar;D=get(gcf,'Position');</span>
                        <span class="comment">% set(gcf,'Position',[0 D(2) D(3)/2 D(4)])</span>
                    <span class="keyword">end</span>
                <span class="keyword">end</span>
                close <span class="string">all</span>
            <span class="keyword">end</span>


            <span class="keyword">if</span> ch23==2
                poss3=9;
                ch3=0;
                <span class="keyword">while</span> ch3~=poss3
                    ch3=menu(<span class="string">'Mel Space for :'</span>,<span class="string">'Signal 1'</span>,<span class="string">'Signal 2'</span>,<span class="string">'Signal 3'</span>,<span class="keyword">...</span>
                        <span class="string">'Signal 4'</span>,<span class="string">'Signal 5'</span>,<span class="string">'Signal 6'</span>,<span class="string">'Signal 7'</span>,<span class="string">'Signal 8'</span>,<span class="string">'Exit'</span>);
                    <span class="keyword">if</span> ch3~=9
                        frames = blockFrames(str{ch3}, fstr{ch3}, M, N);
                        m = melfb(20, N, fstr{ch3});
                        z = m * abs(frames(1:n2, :)).^2;
                        tm = length(str{ch3}) / fstr{ch3};
                        subplot(121)
                        imagesc([0 tm], [0 fstr{ch3}/2], abs(frames(1:n2, :)).^2), axis <span class="string">xy</span>;
                        title(<span class="string">'Power Spectrum unmodified'</span>);
                        xlabel(<span class="string">'Time [s]'</span>);
                        ylabel(<span class="string">'Frequency [Hz]'</span>);
                        colorbar;
                        subplot(122)
                        imagesc([0 tm], [0 20], z), axis <span class="string">xy</span>;
                        title(<span class="string">'Power Spectrum modified through Mel Cepstrum filter'</span>);
                        xlabel(<span class="string">'Time [s]'</span>);
                        ylabel(<span class="string">'Number of Filter in Filter Bank'</span>);
                        <span class="comment">% colorbar;D=get(gcf,'Position');</span>
                        <span class="comment">% set(gcf,'Position',[0 D(2) D(3)/2 D(4)])</span>
                    <span class="keyword">end</span>
                <span class="keyword">end</span>
                close <span class="string">all</span>;
            <span class="keyword">end</span>

            <span class="keyword">if</span> ch23==3

                <span class="keyword">if</span> (exist(<span class="string">'sound_database.dat'</span>,<span class="string">'file'</span>)==2)
                    load(<span class="string">'sound_database.dat'</span>,<span class="string">'-mat'</span>);

                    ch32=0;
                    <span class="keyword">while</span> ch32 ~=2
                        ch32=menu(<span class="string">'Database Information'</span>,<span class="string">'Database'</span>,<span class="string">'Exit'</span>);

                        <span class="keyword">if</span> ch32==1
                            st=strcat(<span class="string">'Sound Database has : #'</span>,num2str(sound_number),<span class="string">'words. Enter a database number : #'</span>);
                            prompt = {st};
                            dlg_title = <span class="string">'Database Information'</span>;
                            num_lines = 1;
                            def = {<span class="string">'1'</span>};
                            options.Resize=<span class="string">'on'</span>;
                            options.WindowStyle=<span class="string">'normal'</span>;
                            options.Interpreter=<span class="string">'tex'</span>;
                            an = inputdlg(prompt,dlg_title,num_lines,def);
                            an=cell2mat(an);
                            a=str2double(an);

                            <span class="keyword">if</span> (isempty(an))

                            <span class="keyword">else</span>

                                <span class="keyword">if</span> (a &lt;= sound_number)
                                    st=strcat(<span class="string">'u'</span>,num2str(an));
                                    [s fs]=wavread(st);
                                    frames = blockFrames(s, fs, M, N);
                                    m = melfb(20, N, fs);
                                    z = m * abs(frames(1:n2, :)).^2;
                                    tm = length(s) / fs;
                                    subplot(121)
                                    imagesc([0 tm], [0 fs/2], abs(frames(1:n2, :)).^2), axis <span class="string">xy</span>;
                                    title(<span class="string">'Power Spectrum unmodified'</span>);
                                    xlabel(<span class="string">'Time [s]'</span>);
                                    ylabel(<span class="string">'Frequency [Hz]'</span>);
                                    colorbar;
                                    subplot(122)
                                    imagesc([0 tm], [0 20], z), axis <span class="string">xy</span>;
                                    title(<span class="string">'Power Spectrum modified through Mel Cepstrum filter'</span>);
                                    xlabel(<span class="string">'Time [s]'</span>);
                                    ylabel(<span class="string">'Number of Filter in Filter Bank'</span>);
                                    colorbar;
                                <span class="keyword">else</span>
                                    warndlg(<span class="string">'Invalid Word '</span>,<span class="string">'Warning'</span>);
                                <span class="keyword">end</span>
                            <span class="keyword">end</span>
                        <span class="keyword">end</span>
                    <span class="keyword">end</span>
                    close <span class="string">all</span>;

                <span class="keyword">else</span>
                    warndlg(<span class="string">'Database is empty.'</span>,<span class="string">' Warning '</span>)
                <span class="keyword">end</span>
            <span class="keyword">end</span>

        <span class="keyword">end</span>
    <span class="keyword">end</span>
    <span class="comment">%----------------------------------------------------------------------</span>
</pre><h2>7: 2D plot of accustic vectors<a name="9"></a></h2><pre class="codeinput">    <span class="comment">% To inspect the acoustic space (MFCC vectors) we can pick any two</span>
    <span class="comment">% dimensions (say the 5th and the 6th) and plot the data points in a 2D</span>
    <span class="comment">% plane. Use acoustic vectors of two different speakers and plot data</span>
    <span class="comment">% points in two different colours. Do the data regions from the two</span>
    <span class="comment">% speakers overlap each other? Are they in clusters?</span>
    <span class="comment">%</span>
    <span class="comment">% Mostly the two areas overlap. But certain regions seem to be used</span>
    <span class="comment">% exclusively by one or the other speaker. This is what will allow us to</span>
    <span class="comment">% distinguish the different speakers.</span>
    <span class="comment">% The points don't form actual clusters, but there are areas where the</span>
    <span class="comment">% density of points is higher.</span>
    <span class="comment">% Note: This is only a two dimensional plot. The actual vector</span>
    <span class="comment">% contains 20 dimensions.</span>

    <span class="keyword">if</span> ch==7
        disp(<span class="string">'&gt;  7: 2D plot of accustic vectors'</span>);

        ch23=0;
        <span class="keyword">while</span> ch23~=4
            ch23=menu(<span class="string">'Select Folder'</span>,<span class="string">'Train'</span>,<span class="string">'Test'</span>,<span class="string">'User'</span>,<span class="string">'Exit'</span>);

            <span class="keyword">if</span> ch23==1
                poss3=3;
                ch3=0;
                <span class="keyword">while</span> ch3~=poss3
                    ch3=menu(<span class="string">'2D plot of accustic vectors representation : '</span>,<span class="string">'1. One Signal'</span>,<span class="keyword">...</span>
                        <span class="string">'2. Two Signal'</span>,<span class="string">'3. Exit'</span>);

                    <span class="keyword">if</span> ch3==1
                        ch31=0;
                        <span class="keyword">while</span> ch31~=9
                            ch31=menu(<span class="string">'2D plot of accustic vectors for :'</span>,<span class="string">'Signal 1'</span>,<span class="string">'Signal 2'</span>,<span class="string">'Signal 3'</span>,<span class="keyword">...</span>
                                <span class="string">'Signal 4'</span>,<span class="string">'Signal 5'</span>,<span class="string">'Signal 6'</span>,<span class="string">'Signal 7'</span>,<span class="string">'Signal 8'</span>,<span class="string">'Exit'</span>);
                            <span class="keyword">if</span> ch31~=9
                                plot(ctr{ch31}(5, :), ctr{ch31}(6, :), <span class="string">'or'</span>);
                                xlabel(<span class="string">'5th Dimension'</span>);
                                ylabel(<span class="string">'6th Dimension'</span>);
                                st=sprintf(<span class="string">'Signal %d '</span>,ch31);
                                legend(st);
                                title(<span class="string">'2D plot of accoustic vectors'</span>);
                            <span class="keyword">end</span>
                        <span class="keyword">end</span>
                        close <span class="string">all</span>;
                    <span class="keyword">end</span>

                    <span class="keyword">if</span> ch3==2
                        ch32=0;
                        <span class="keyword">while</span> ch32~=8
                            ch32=menu(<span class="string">'2D plot of accustic vectors for :'</span>,<span class="string">'Signal 1 &amp; Signal 2'</span>,<span class="keyword">...</span>
                                <span class="string">'Signal 2 &amp; Signal 3'</span>,<span class="string">'Signal 3 &amp; Signal 4'</span>,<span class="string">'Signal 4 &amp; Signal 5'</span>,<span class="keyword">...</span>
                                <span class="string">'Signal 5 &amp; Signal 6'</span>,<span class="string">'Signal 6 &amp; Signal 7'</span>,<span class="string">'Signal 7 &amp; Signal 8'</span>,<span class="string">'Exit'</span>);
                            <span class="keyword">if</span> ch32~=8
                                plot(ctr{ch32}(5, :), ctr{ch32}(6, :), <span class="string">'or'</span>);
                                hold <span class="string">on</span>;
                                plot(ctr{ch32+1}(5, :), ctr{ch32+1}(6, :), <span class="string">'xb'</span>);
                                xlabel(<span class="string">'5th Dimension'</span>);
                                ylabel(<span class="string">'6th Dimension'</span>);
                                st=sprintf(<span class="string">'Signal %d,'</span>,ch32);
                                st1=sprintf(<span class="string">'Signal %d'</span>, (ch32+1) );
                                legend(st,st1);
                                title(<span class="string">'2D plot of accoustic vectors'</span>);
                                hold <span class="string">off</span>
                            <span class="keyword">end</span>
                        <span class="keyword">end</span>
                    <span class="keyword">end</span>
                    close <span class="string">all</span>
                <span class="keyword">end</span>
            <span class="keyword">end</span>

            <span class="keyword">if</span> ch23==2
                poss3=3;
                ch3=0;
                <span class="keyword">while</span> ch3~=poss3
                    ch3=menu(<span class="string">'2D plot of accustic vectors representation : '</span>,<span class="string">'1. One Signal'</span>,<span class="keyword">...</span>
                        <span class="string">'2. Two Signal'</span>,<span class="string">'3. Exit'</span>);

                    <span class="keyword">if</span> ch3==1
                        ch31=0;
                        <span class="keyword">while</span> ch31~=9
                            ch31=menu(<span class="string">'2D plot of accustic vectors for :'</span>,<span class="string">'Signal 1'</span>,<span class="string">'Signal 2'</span>,<span class="string">'Signal 3'</span>,<span class="keyword">...</span>
                                <span class="string">'Signal 4'</span>,<span class="string">'Signal 5'</span>,<span class="string">'Signal 6'</span>,<span class="string">'Signal 7'</span>,<span class="string">'Signal 8'</span>,<span class="string">'Exit'</span>);
                            <span class="keyword">if</span> ch31~=9
                                plot(cte{ch31}(5, :), cte{ch31}(6, :), <span class="string">'or'</span>);
                                xlabel(<span class="string">'5th Dimension'</span>);
                                ylabel(<span class="string">'6th Dimension'</span>);
                                st=sprintf(<span class="string">'Signal %d '</span>,ch31);
                                legend(st);
                                title(<span class="string">'2D plot of accoustic vectors'</span>);
                            <span class="keyword">end</span>
                        <span class="keyword">end</span>
                        close <span class="string">all</span>;
                    <span class="keyword">end</span>

                    <span class="keyword">if</span> ch3==2
                        ch32=0;
                        <span class="keyword">while</span> ch32~=8
                            ch32=menu(<span class="string">'2D plot of accustic vectors for :'</span>,<span class="string">'Signal 1 &amp; Signal 2'</span>,<span class="keyword">...</span>
                                <span class="string">'Signal 2 &amp; Signal 3'</span>,<span class="string">'Signal 3 &amp; Signal 4'</span>,<span class="string">'Signal 4 &amp; Signal 5'</span>,<span class="keyword">...</span>
                                <span class="string">'Signal 5 &amp; Signal 6'</span>,<span class="string">'Signal 6 &amp; Signal 7'</span>,<span class="string">'Signal 7 &amp; Signal 8'</span>,<span class="string">'Exit'</span>);

                            <span class="keyword">if</span> ch32~=8
                                plot(cte{ch32}(5, :), cte{ch32}(6, :), <span class="string">'or'</span>);
                                hold <span class="string">on</span>;
                                plot(cte{ch32+1}(5, :), cte{ch32+1}(6, :), <span class="string">'xb'</span>);
                                xlabel(<span class="string">'5th Dimension'</span>);
                                ylabel(<span class="string">'6th Dimension'</span>);
                                st=sprintf(<span class="string">'Signal %d,'</span>,ch32);
                                st1=sprintf(<span class="string">'Signal %d'</span>, (ch32+1) );
                                legend(st,st1);
                                title(<span class="string">'2D plot of accoustic vectors'</span>);
                                hold <span class="string">off</span>
                            <span class="keyword">end</span>
                        <span class="keyword">end</span>
                    <span class="keyword">end</span>
                    close <span class="string">all</span>
                <span class="keyword">end</span>
            <span class="keyword">end</span>

            <span class="keyword">if</span> ch23==3

                <span class="keyword">if</span> (exist(<span class="string">'sound_database.dat'</span>,<span class="string">'file'</span>)==2)
                    load(<span class="string">'sound_database.dat'</span>,<span class="string">'-mat'</span>);

                    ch32=0;
                    <span class="keyword">while</span> ch32 ~=2
                        ch32=menu(<span class="string">'Database Information'</span>,<span class="string">'Database'</span>,<span class="string">'Exit'</span>);

                        <span class="keyword">if</span> ch32==1
                            st=strcat(<span class="string">'Sound Database has : #'</span>,num2str(sound_number),<span class="string">'words. Enter a database number : #'</span>);
                            prompt = {st};
                            dlg_title = <span class="string">'Database Information'</span>;
                            num_lines = 1;
                            def = {<span class="string">'1'</span>};
                            options.Resize=<span class="string">'on'</span>;
                            options.WindowStyle=<span class="string">'normal'</span>;
                            options.Interpreter=<span class="string">'tex'</span>;
                            an = inputdlg(prompt,dlg_title,num_lines,def);
                            an=cell2mat(an);
                            a=str2double(an);

                            <span class="keyword">if</span> (isempty(an))

                            <span class="keyword">else</span>

                                <span class="keyword">if</span> (a &lt;= sound_number)
                                    st=strcat(<span class="string">'u'</span>,num2str(an));
                                    [s fs]=wavread(st);
                                    c = mfcc(s, fs);
                                    plot(c(5, :), c(6, :), <span class="string">'or'</span>);
                                    xlabel(<span class="string">'5th Dimension'</span>);
                                    ylabel(<span class="string">'6th Dimension'</span>);
                                    st1=sprintf(<span class="string">'Signal %s.wav'</span>,st);
                                    legend(st1);
                                    title(<span class="string">'2D plot of accoustic vectors'</span>);
                                <span class="keyword">else</span>
                                    warndlg(<span class="string">'Invalid Word '</span>,<span class="string">'Warning'</span>);
                                <span class="keyword">end</span>
                            <span class="keyword">end</span>
                        <span class="keyword">end</span>
                    <span class="keyword">end</span>
                    close <span class="string">all</span>;

                <span class="keyword">else</span>
                    warndlg(<span class="string">'Database is empty.'</span>,<span class="string">' Warning '</span>)
                <span class="keyword">end</span>
            <span class="keyword">end</span>

        <span class="keyword">end</span>
    <span class="keyword">end</span>
    <span class="comment">%----------------------------------------------------------------------</span>
</pre><h2>8: Plot of the 2D trained VQ codewords<a name="10"></a></h2><pre class="codeinput">    <span class="comment">% Plot the data points of the trained VQ codeword using the two dimensions</span>
    <span class="comment">% previously used for the plot of the last question.</span>
    <span class="comment">% The example in previous figure is an ideal case for teaching. In reality</span>
    <span class="comment">% however the clusters cannot be that easily distinguished. But again, this</span>
    <span class="comment">% is a two dimensional representation of a 20 dimensions space.</span>

    <span class="keyword">if</span> ch==8
        disp(<span class="string">'&gt;  8: Plot of the 2D trained VQ codewords'</span>);

        ch23=0;
        <span class="keyword">while</span> ch23~=4
            ch23=menu(<span class="string">'Select Folder'</span>,<span class="string">'Train'</span>,<span class="string">'Test'</span>,<span class="string">'User'</span>,<span class="string">'Exit'</span>);

            <span class="keyword">if</span> ch23==1
                poss3=3;
                ch3=0;
                <span class="keyword">while</span> ch3~=poss3
                    ch3=menu(<span class="string">'2D plot of accustic vectors representation : '</span>,<span class="string">'1. One Signal'</span>,<span class="keyword">...</span>
                        <span class="string">'2. Two Signal'</span>,<span class="string">'3. Exit'</span>);

                    <span class="keyword">if</span> ch3==1
                        ch31=0;
                        <span class="keyword">while</span> ch31~=9
                            ch31=menu(<span class="string">'2D plot of accustic vectors for :'</span>,<span class="string">'Signal 1'</span>,<span class="string">'Signal 2'</span>,<span class="string">'Signal 3'</span>,<span class="keyword">...</span>
                                <span class="string">'Signal 4'</span>,<span class="string">'Signal 5'</span>,<span class="string">'Signal 6'</span>,<span class="string">'Signal 7'</span>,<span class="string">'Signal 8'</span>,<span class="string">'Exit'</span>);

                            <span class="keyword">if</span> ch31~=9
                                plot(ctr{ch31}(5, :), ctr{ch31}(6, :), <span class="string">'xr'</span>)
                                hold <span class="string">on</span>
                                plot(dtr{ch31}(5, :), dtr{ch31}(6, :), <span class="string">'vk'</span>)
                                xlabel(<span class="string">'5th Dimension'</span>);
                                ylabel(<span class="string">'6th Dimension'</span>);
                                st=sprintf(<span class="string">'Speaker %d'</span>,ch31);
                                st1=sprintf(<span class="string">'Codebook %d'</span>, (ch31) );
                                legend(st,st1);
                                title(<span class="string">'2D plot of accoustic vectors'</span>);
                                hold <span class="string">off</span>
                            <span class="keyword">end</span>
                        <span class="keyword">end</span>
                        close <span class="string">all</span>
                    <span class="keyword">end</span>

                    <span class="keyword">if</span> ch3==2
                        ch32=0;
                        <span class="keyword">while</span> ch32~=8
                            ch32=menu(<span class="string">'2D plot of accustic vectors for :'</span>,<span class="string">'Signal 1 &amp; Signal 2'</span>,<span class="keyword">...</span>
                                <span class="string">'Signal 2 &amp; Signal 3'</span>,<span class="string">'Signal 3 &amp; Signal 4'</span>,<span class="string">'Signal 4 &amp; Signal 5'</span>,<span class="keyword">...</span>
                                <span class="string">'Signal 5 &amp; Signal 6'</span>,<span class="string">'Signal 6 &amp; Signal 7'</span>,<span class="string">'Signal 7 &amp; Signal 8'</span>,<span class="string">'Exit'</span>);

                            <span class="keyword">if</span> ch32~=8
                                plot(ctr{ch32}(5, :), ctr{ch32}(6, :), <span class="string">'xr'</span>)
                                hold <span class="string">on</span>
                                plot(dtr{ch32}(5, :), dtr{ch32}(6, :), <span class="string">'vk'</span>)
                                plot(ctr{ch32+1}(5, :), ctr{ch32+1}(6, :), <span class="string">'xb'</span>)
                                plot(dtr{ch32+1}(5, :), dtr{ch32+1}(6, :), <span class="string">'+k'</span>)
                                xlabel(<span class="string">'5th Dimension'</span>);
                                ylabel(<span class="string">'6th Dimension'</span>);
                                st=sprintf(<span class="string">'Speaker %d'</span>,ch32);
                                st1=sprintf(<span class="string">'Codebook %d'</span>,ch32 );
                                st2=sprintf(<span class="string">'Speaker %d'</span>,(ch32+1) );
                                st3=sprintf(<span class="string">'Codebook %d'</span>, (ch32+1) );
                                legend(st,st1,st2,st3);
                                title(<span class="string">'2D plot of accoustic vectors'</span>);
                                hold <span class="string">off</span>
                            <span class="keyword">end</span>
                        <span class="keyword">end</span>
                    <span class="keyword">end</span>
                    close <span class="string">all</span>
                <span class="keyword">end</span>
            <span class="keyword">end</span>

            <span class="keyword">if</span> ch23==2
                poss3=3;
                ch3=0;
                <span class="keyword">while</span> ch3~=poss3
                    ch3=menu(<span class="string">'2D plot of accustic vectors representation : '</span>,<span class="string">'1. One Signal'</span>,<span class="keyword">...</span>
                        <span class="string">'2. Two Signal'</span>,<span class="string">'3. Exit'</span>);

                    <span class="keyword">if</span> ch3==1
                        ch31=0;
                        <span class="keyword">while</span> ch31~=9
                            ch31=menu(<span class="string">'2D plot of accustic vectors for :'</span>,<span class="string">'Signal 1'</span>,<span class="string">'Signal 2'</span>,<span class="string">'Signal 3'</span>,<span class="keyword">...</span>
                                <span class="string">'Signal 4'</span>,<span class="string">'Signal 5'</span>,<span class="string">'Signal 6'</span>,<span class="string">'Signal 7'</span>,<span class="string">'Signal 8'</span>,<span class="string">'Exit'</span>);

                            <span class="keyword">if</span> ch31~=9
                                plot(cte{ch31}(5, :), cte{ch31}(6, :), <span class="string">'xr'</span>)
                                hold <span class="string">on</span>
                                plot(dte{ch31}(5, :), dte{ch31}(6, :), <span class="string">'vk'</span>)
                                xlabel(<span class="string">'5th Dimension'</span>);
                                ylabel(<span class="string">'6th Dimension'</span>);
                                st=sprintf(<span class="string">'Speaker %d'</span>,ch31);
                                st1=sprintf(<span class="string">'Codebook %d'</span>, (ch31) );
                                legend(st,st1);
                                title(<span class="string">'2D plot of accoustic vectors'</span>);
                                hold <span class="string">off</span>
                            <span class="keyword">end</span>
                        <span class="keyword">end</span>
                        close <span class="string">all</span>
                    <span class="keyword">end</span>

                    <span class="keyword">if</span> ch3==2
                        ch32=0;
                        <span class="keyword">while</span> ch32~=8
                            ch32=menu(<span class="string">'2D plot of accustic vectors for :'</span>,<span class="string">'Signal 1 &amp; Signal 2'</span>,<span class="keyword">...</span>
                                <span class="string">'Signal 2 &amp; Signal 3'</span>,<span class="string">'Signal 3 &amp; Signal 4'</span>,<span class="string">'Signal 4 &amp; Signal 5'</span>,<span class="keyword">...</span>
                                <span class="string">'Signal 5 &amp; Signal 6'</span>,<span class="string">'Signal 6 &amp; Signal 7'</span>,<span class="string">'Signal 7 &amp; Signal 8'</span>,<span class="string">'Exit'</span>);

                            <span class="keyword">if</span> ch32~=8
                                plot(cte{ch32}(5, :), cte{ch32}(6, :), <span class="string">'xr'</span>)
                                hold <span class="string">on</span>
                                plot(dte{ch32}(5, :), dte{ch32}(6, :), <span class="string">'vk'</span>)
                                plot(cte{ch32+1}(5, :), cte{ch32+1}(6, :), <span class="string">'xb'</span>)
                                plot(dte{ch32+1}(5, :), dte{ch32+1}(6, :), <span class="string">'+k'</span>)
                                xlabel(<span class="string">'5th Dimension'</span>);
                                ylabel(<span class="string">'6th Dimension'</span>);
                                st=sprintf(<span class="string">'Speaker %d'</span>,ch32);
                                st1=sprintf(<span class="string">'Codebook %d'</span>,ch32 );
                                st2=sprintf(<span class="string">'Speaker %d'</span>, (ch32+1) );
                                st3=sprintf(<span class="string">'Codebook %d'</span>, (ch32+1) );
                                legend(st,st1,st2,st3);
                                title(<span class="string">'2D plot of accoustic vectors'</span>);
                                hold <span class="string">off</span>
                            <span class="keyword">end</span>
                        <span class="keyword">end</span>
                    <span class="keyword">end</span>
                    close <span class="string">all</span>
                <span class="keyword">end</span>
            <span class="keyword">end</span>

            <span class="keyword">if</span> ch23==3

                <span class="keyword">if</span> (exist(<span class="string">'sound_database.dat'</span>,<span class="string">'file'</span>)==2)
                    load(<span class="string">'sound_database.dat'</span>,<span class="string">'-mat'</span>);

                    ch32=0;
                    <span class="keyword">while</span> ch32 ~=2
                        ch32=menu(<span class="string">'Database Information'</span>,<span class="string">'Database'</span>,<span class="string">'Exit'</span>);

                        <span class="keyword">if</span> ch32==1
                            st=strcat(<span class="string">'Sound Database has : #'</span>,num2str(sound_number),<span class="string">'words. Enter a database number : #'</span>);
                            prompt = {st};
                            dlg_title = <span class="string">'Database Information'</span>;
                            num_lines = 1;
                            def = {<span class="string">'1'</span>};
                            options.Resize=<span class="string">'on'</span>;
                            options.WindowStyle=<span class="string">'normal'</span>;
                            options.Interpreter=<span class="string">'tex'</span>;
                            an = inputdlg(prompt,dlg_title,num_lines,def);
                            an=cell2mat(an);
                            a=str2double(an);

                            <span class="keyword">if</span> (isempty(an))

                            <span class="keyword">else</span>

                                <span class="keyword">if</span> (a &lt;= sound_number)
                                    st=strcat(<span class="string">'u'</span>,num2str(an));
                                    [s fs]=wavread(st);
                                    c = mfcc(s, fs);
                                    d = vqlbg(c, 16);
                                    plot(c(5, :), c(6, :), <span class="string">'xr'</span>);
                                    hold <span class="string">on</span>
                                    plot(d(5, :), d(6, :), <span class="string">'vk'</span>);
                                    xlabel(<span class="string">'5th Dimension'</span>);
                                    ylabel(<span class="string">'6th Dimension'</span>);
                                    st1=sprintf(<span class="string">'Speaker %s'</span>,st);
                                    st2=sprintf(<span class="string">'Codebook %s'</span>,st);
                                    legend(st1,st2);
                                    title(<span class="string">'2D plot of accoustic vectors'</span>);
                                    hold <span class="string">off</span>
                                <span class="keyword">else</span>
                                    warndlg(<span class="string">'Invalid Word '</span>,<span class="string">'Warning'</span>);
                                <span class="keyword">end</span>
                            <span class="keyword">end</span>
                        <span class="keyword">end</span>
                    <span class="keyword">end</span>
                    close <span class="string">all</span>;

                <span class="keyword">else</span>
                    warndlg(<span class="string">'Database is empty.'</span>,<span class="string">' Warning '</span>)
                <span class="keyword">end</span>
            <span class="keyword">end</span>

        <span class="keyword">end</span>
    <span class="keyword">end</span>
    <span class="comment">%----------------------------------------------------------------------</span>
</pre><h2>9: Recognition rate of the computer<a name="11"></a></h2><pre class="codeinput">    <span class="comment">% What is the recognition rate that our system can perform? Compare this</span>
    <span class="comment">% with the human's performances. Observe as well if the system makes errors</span>
    <span class="comment">% on the speech samples. If so, re -listen to the speech files and try to</span>
    <span class="comment">% come up with some explanations.</span>
    <span class="comment">% We used the following commands to test the system:</span>
    <span class="comment">%</span>
    <span class="comment">% The result is:</span>
    <span class="comment">% Our system was able to recognize 8 out of 8 speakers. This is an error</span>
    <span class="comment">% rate of 0.00%. The recognition rate of our system is much better than the</span>
    <span class="comment">% one of a human's recognition rate However you must be aware that this</span>
    <span class="comment">% test is not really representative of the computer's efficiency to</span>
    <span class="comment">% recognize voices because we only tested on 8 persons, with only one</span>
    <span class="comment">% training session and with only one word.</span>
    <span class="comment">%</span>
    <span class="comment">% Speaker 1 matches with speaker 1</span>
    <span class="comment">% Speaker 2 matches with speaker 2</span>
    <span class="comment">% Speaker 3 matches with speaker 3</span>
    <span class="comment">% Speaker 4 matches with speaker 4</span>
    <span class="comment">% Speaker 5 matches with speaker 5</span>
    <span class="comment">% Speaker 6 matches with speaker 6</span>
    <span class="comment">% Speaker 7 matches with speaker 7</span>
    <span class="comment">% Speaker 8 matches with speaker 8</span>

    <span class="keyword">if</span> ch==9
        disp(<span class="string">'&gt; 9: Recognition rate of the computer'</span>)
        <span class="comment">%----------------------------------------------------------------------</span>
</pre><h2>9.1 Loading from Test Folder for Comparison<a name="12"></a></h2>
         <p>All 8 samples data values are loaded in file sounddatabase1.dat.</p><pre class="codeinput">        <span class="keyword">for</span> sound_number = 1: 8
            <span class="keyword">if</span> size(ste{sound_number},2)==2
                ste{sound_number}=ste{sound_number}(:,1);
            <span class="keyword">end</span>
            ste{sound_number} = double( ste{sound_number} );
            data{sound_number,1} = ste{sound_number};
            data{sound_number,2} = sound_number;
            st = sprintf(<span class="string">'s%d.wav'</span>,sound_number);
            data{sound_number,3} = st;
            data{sound_number,4} = <span class="string">'Test'</span>;
            fs=fste{sound_number}; <span class="comment">%#ok&lt;NASGU&gt;</span>
            nb=nbte{sound_number}; <span class="comment">%#ok&lt;NASGU&gt;</span>
            <span class="keyword">if</span> sound_number == 1;
                save(<span class="string">'sound_database1.dat'</span>,<span class="string">'data'</span>,<span class="string">'sound_number'</span>,<span class="string">'fs'</span>,<span class="string">'nb'</span>);
            <span class="keyword">else</span>
                save(<span class="string">'sound_database1.dat'</span>,<span class="string">'data'</span>,<span class="string">'sound_number'</span>,<span class="string">'fs'</span>,<span class="string">'nb'</span>,<span class="string">'-append'</span>);
            <span class="keyword">end</span>
        <span class="keyword">end</span>

        disp(<span class="string">' '</span>);
        disp(<span class="string">'Sounds From TEST added to database for comparison'</span>);
        disp(<span class="string">' '</span>);
        <span class="comment">%----------------------------------------------------------------------</span>
</pre><h2>9.2 Comparing one by one data from TRAIN FOLDER<a name="13"></a></h2>
         <p>From Train folder samples are tested one by one to database stored in file sounddatabase1.dat And matching result is given
            on the basis of minimum distortion distance
         </p><pre class="codeinput">        disp(<span class="string">'Comparing one by one data from TRAIN FOLDER'</span>);
        disp(<span class="string">' '</span>);
        load(<span class="string">'sound_database1.dat'</span>,<span class="string">'-mat'</span>);

        <span class="keyword">for</span> classe = 1:8
            st = sprintf(<span class="string">'Train\\S%d.wav to be compared'</span>,classe);
            disp(st);
            pause(0.5);
            <span class="keyword">if</span> size(str{classe},2)==2
                str{classe}=str{classe}(:,1);
            <span class="keyword">end</span>
            str{classe} = double(str{classe});
            <span class="comment">%----- code for speaker recognition -------</span>
            disp(<span class="string">'MFCC cofficients computation and VQ codebook training in progress...'</span>);
            <span class="comment">% Number of centroids required</span>
            k =16;
            <span class="keyword">for</span> ii=1:sound_number
                <span class="comment">% Compute MFCC cofficients for each sound present in database</span>
                v = mfcc(data{ii,1}, fstr{classe});
                <span class="comment">% Train VQ codebook</span>
                code{ii} = vqlbg(v, k);
            <span class="keyword">end</span>
            disp(<span class="string">'Completed.'</span>);
            disp(<span class="string">' '</span>);
            <span class="comment">% Compute MFCC coefficients for input sound</span>
            v = mfcc(str{classe},fstr{classe});
            <span class="comment">% Current distance and sound ID initialization</span>
            distmin = Inf;
            k1 = 0;
            <span class="keyword">for</span> ii=1:sound_number
                d = disteu(v, code{ii});
                dist = sum(min(d,[],2)) / size(d,1);
                <span class="keyword">if</span> dist &lt; distmin
                    distmin = dist;
                    k1 = ii;
                <span class="keyword">end</span>
            <span class="keyword">end</span>
            min_index = k1;
            speech_id = data{min_index,2};
            <span class="comment">%-----------------------------------------</span>
            disp(<span class="string">'Matching sound:'</span>);
            disp(<span class="string">' '</span>);
            message=strcat(<span class="string">'File:'</span>,data{min_index,3});
            disp(message);
            message=strcat(<span class="string">'Location:'</span>,data{min_index,4});
            disp(message);
            message = strcat(<span class="string">'Recognized speaker ID: '</span>,num2str(speech_id));
            disp(message);
            disp(<span class="string">' '</span>);
        <span class="keyword">end</span>

        disp(<span class="string">'                                                             '</span>);
        pause(0.5)
        msgbox(<span class="string">'This prototype is 100% efficient in recognising these 8 different stored sounds in TEST and TRAIN folders. '</span>,<span class="string">'Success'</span>,<span class="string">'help'</span>);
    <span class="keyword">end</span>
    <span class="comment">%----------------------------------------------------------------------</span>
</pre><h2>9.3 Note: Test with other speech files<a name="14"></a></h2><pre class="codeinput">    <span class="comment">% You can also test the system with your own speech files. Use the Windows</span>
    <span class="comment">% program Sound Recorder to record your own voice and your friends' voices</span>
    <span class="comment">% Each new speaker needs to pro vide one speech file for training and one</span>
    <span class="comment">% for testing. Can the system recognize your voice? Enjoy.</span>
    <span class="comment">%----------------------------------------------------------------------</span>
</pre><h2>10: Voice Recognition by letting user enter into database and then compare<a name="15"></a></h2><pre class="codeinput">    <span class="comment">%Voice recognition is the process of automatically recognizing who is</span>
    <span class="comment">%speaking on the basis of individual information included in speech waves.</span>
    <span class="comment">%</span>
    <span class="comment">%This technique makes it possible to use the speaker's voice to verify</span>
    <span class="comment">%their identity and control access to services such as voice dialing,</span>
    <span class="comment">%telephone shopping, database access services, information</span>
    <span class="comment">%services, voice mail, and remote access to computers.</span>



    <span class="keyword">if</span> ch==10
        disp(<span class="string">'&gt; 10: Test with other speech files'</span>)
        msgbox(<span class="string">'P.S. This prototype is for secondary security usage.'</span>,<span class="string">'NOTE'</span>,<span class="string">'help'</span>);
        pause(2);
        msgbox(<span class="string">'Kindly Note this works for the stored databases only. This means that you can add sounds to the database by users and Recognition will be done for the users entered. '</span>,<span class="string">'NOTE'</span>,<span class="string">'help'</span>)
        pause(2);

        chos=0;
        possibility=5;
        <span class="keyword">while</span> chos~=possibility,
            chos=menu(<span class="string">'Speaker Recognition System'</span>,<span class="string">'Add a new sound from microphone'</span>,<span class="keyword">...</span>
                <span class="string">'Speaker recognition from microphone'</span>,<span class="keyword">...</span>
                <span class="string">'Database Info'</span>,<span class="string">'Delete database'</span>,<span class="string">'Exit'</span>);

            <span class="comment">%----------------------------------------------------------------------</span>
</pre><h2>10.1 Add a new sound from microphone<a name="16"></a></h2><pre class="codeinput">            <span class="keyword">if</span> chos==1

                <span class="keyword">if</span> (exist(<span class="string">'sound_database.dat'</span>,<span class="string">'file'</span>)==2)
                    load(<span class="string">'sound_database.dat'</span>,<span class="string">'-mat'</span>);
                    classe = input(<span class="string">'Insert a class number (sound ID) that will be used for recognition:'</span>);
                    <span class="keyword">if</span> isempty(classe)
                        classe = sound_number+1;
                        disp( num2str(classe) );
                    <span class="keyword">end</span>
                    message=(<span class="string">'The following parameters will be used during recording:'</span>);
                    disp(message);
                    message=strcat(<span class="string">'Sampling frequency'</span>,num2str(samplingfrequency));
                    disp(message);
                    message=strcat(<span class="string">'Bits per sample'</span>,num2str(samplingbits));
                    disp(message);
                    durata = input(<span class="string">'Insert the duration of the recording (in seconds):'</span>);
                    <span class="keyword">if</span> isempty(durata)
                        durata = 3;
                        disp( num2str(durata) );
                    <span class="keyword">end</span>
                    micrecorder = audiorecorder(samplingfrequency,samplingbits,1);
                    disp(<span class="string">'Now, speak into microphone...'</span>);
                    record(micrecorder,durata);

                    <span class="keyword">while</span> (isrecording(micrecorder)==1)
                        disp(<span class="string">'Recording...'</span>);
                        pause(0.5);
                    <span class="keyword">end</span>
                    disp(<span class="string">'Recording stopped.'</span>);
                    y1 = getaudiodata(micrecorder);
                    y = getaudiodata(micrecorder, <span class="string">'uint8'</span>);

                    <span class="keyword">if</span> size(y,2)==2
                        y=y(:,1);
                    <span class="keyword">end</span>
                    y = double(y);
                    sound_number = sound_number+1;
                    data{sound_number,1} = y;
                    data{sound_number,2} = classe;
                    data{sound_number,3} = <span class="string">'Microphone'</span>;
                    data{sound_number,4} = <span class="string">'Microphone'</span>;
                    st=strcat(<span class="string">'u'</span>,num2str(sound_number));
                    wavwrite(y1,samplingfrequency,samplingbits,st)
                    save(<span class="string">'sound_database.dat'</span>,<span class="string">'data'</span>,<span class="string">'sound_number'</span>,<span class="string">'-append'</span>);
                    msgbox(<span class="string">'Sound added to database'</span>,<span class="string">'Database result'</span>,<span class="string">'help'</span>);
                    disp(<span class="string">'Sound added to database'</span>);

                <span class="keyword">else</span>
                    classe = input(<span class="string">'Insert a class number (sound ID) that will be used for recognition:'</span>);
                    <span class="keyword">if</span> isempty(classe)
                        classe = 1;
                        disp( num2str(classe) );
                    <span class="keyword">end</span>
                    durata = input(<span class="string">'Insert the duration of the recording (in seconds):'</span>);
                    <span class="keyword">if</span> isempty(durata)
                        durata = 3;
                        disp( num2str(durata) );
                    <span class="keyword">end</span>
                    samplingfrequency = input(<span class="string">'Insert the sampling frequency (22050 recommended):'</span>);
                    <span class="keyword">if</span> isempty(samplingfrequency )
                        samplingfrequency = 22050;
                        disp( num2str(samplingfrequency) );
                    <span class="keyword">end</span>
                    samplingbits = input(<span class="string">'Insert the number of bits per sample (8 recommended):'</span>);
                    <span class="keyword">if</span> isempty(samplingbits )
                        samplingbits = 8;
                        disp( num2str(samplingbits) );
                    <span class="keyword">end</span>
                    micrecorder = audiorecorder(samplingfrequency,samplingbits,1);
                    disp(<span class="string">'Now, speak into microphone...'</span>);
                    record(micrecorder,durata);

                    <span class="keyword">while</span> (isrecording(micrecorder)==1)
                        disp(<span class="string">'Recording...'</span>);
                        pause(0.5);
                    <span class="keyword">end</span>
                    disp(<span class="string">'Recording stopped.'</span>);
                    y1 = getaudiodata(micrecorder);
                    y = getaudiodata(micrecorder, <span class="string">'uint8'</span>);

                    <span class="keyword">if</span> size(y,2)==2
                        y=y(:,1);
                    <span class="keyword">end</span>
                    y = double(y);
                    sound_number = 1;
                    data{sound_number,1} = y;
                    data{sound_number,2} = classe;
                    data{sound_number,3} = <span class="string">'Microphone'</span>;
                    data{sound_number,4} = <span class="string">'Microphone'</span>;
                    st=strcat(<span class="string">'u'</span>,num2str(sound_number));
                    wavwrite(y1,samplingfrequency,samplingbits,st)
                    save(<span class="string">'sound_database.dat'</span>,<span class="string">'data'</span>,<span class="string">'sound_number'</span>,<span class="string">'samplingfrequency'</span>,<span class="string">'samplingbits'</span>);
                    msgbox(<span class="string">'Sound added to database'</span>,<span class="string">'Database result'</span>,<span class="string">'help'</span>);
                    disp(<span class="string">'Sound added to database'</span>);
                <span class="keyword">end</span>
            <span class="keyword">end</span>

            <span class="comment">%----------------------------------------------------------------------</span>
</pre><h2>10.2 Voice Recognition from microphone<a name="17"></a></h2><pre class="codeinput">            <span class="keyword">if</span> chos==2

                <span class="keyword">if</span> (exist(<span class="string">'sound_database.dat'</span>,<span class="string">'file'</span>)==2)
                    load(<span class="string">'sound_database.dat'</span>,<span class="string">'-mat'</span>);
                    Fs = samplingfrequency;
                    durata = input(<span class="string">'Insert the duration of the recording (in seconds):'</span>);
                    <span class="keyword">if</span> isempty(durata)
                        durata = 3;
                        disp( num2str(durata) );
                    <span class="keyword">end</span>
                    micrecorder = audiorecorder(samplingfrequency,samplingbits,1);
                    disp(<span class="string">'Now, speak into microphone...'</span>);
                    record(micrecorder,durata);

                    <span class="keyword">while</span> (isrecording(micrecorder)==1)
                        disp(<span class="string">'Recording...'</span>);
                        pause(0.5);
                    <span class="keyword">end</span>
                    disp(<span class="string">'Recording stopped.'</span>);
                    y = getaudiodata(micrecorder);
                    st=<span class="string">'v'</span>;
                    wavwrite(y,samplingfrequency,samplingbits,st);
                    y = getaudiodata(micrecorder, <span class="string">'uint8'</span>);
                    <span class="comment">% if the input sound is not mono</span>

                    <span class="keyword">if</span> size(y,2)==2
                        y=y(:,1);
                    <span class="keyword">end</span>
                    y = double(y);
                    <span class="comment">%----- code for speaker recognition -------</span>
                    disp(<span class="string">'MFCC cofficients computation and VQ codebook training in progress...'</span>);
                    disp(<span class="string">' '</span>);
                    <span class="comment">% Number of centroids required</span>
                    k =16;

                    <span class="keyword">for</span> ii=1:sound_number
                        <span class="comment">% Compute MFCC cofficients for each sound present in database</span>
                        v = mfcc(data{ii,1}, Fs);
                        <span class="comment">% Train VQ codebook</span>
                        code{ii} = vqlbg(v, k);
                        disp(<span class="string">'...'</span>);
                    <span class="keyword">end</span>
                    disp(<span class="string">'Completed.'</span>);
                    <span class="comment">% Compute MFCC coefficients for input sound</span>
                    v = mfcc(y,Fs);
                    <span class="comment">% Current distance and sound ID initialization</span>
                    distmin = Inf;
                    k1 = 0;

                    <span class="keyword">for</span> ii=1:sound_number
                        d = disteu(v, code{ii});
                        dist = sum(min(d,[],2)) / size(d,1);
                        message=strcat(<span class="string">'For User #'</span>,num2str(ii),<span class="string">' Dist : '</span>,num2str(dist));
                        disp(message);

                        <span class="keyword">if</span> dist &lt; distmin
                            distmin = dist;
                            k1 = ii;
                        <span class="keyword">end</span>
                    <span class="keyword">end</span>

                    <span class="keyword">if</span> distmin &lt; ronaldo
                        min_index = k1;
                        speech_id = data{min_index,2};
                        <span class="comment">%-----------------------------------------</span>
                        disp(<span class="string">'Matching sound:'</span>);
                        message=strcat(<span class="string">'File:'</span>,data{min_index,3});
                        disp(message);
                        message=strcat(<span class="string">'Location:'</span>,data{min_index,4});
                        disp(message);
                        message = strcat(<span class="string">'Recognized speaker ID: '</span>,num2str(speech_id));
                        disp(message);
                        msgbox(message,<span class="string">'Matching result'</span>,<span class="string">'help'</span>);

                        ch3=0;
                        <span class="keyword">while</span> ch3~=3
                            ch3=menu(<span class="string">'Matched result verification:'</span>,<span class="string">'Recognized Sound'</span>,<span class="string">'Recorded sound'</span>,<span class="string">'Exit'</span>);

                            <span class="keyword">if</span> ch3==1
                                st=strcat(<span class="string">'u'</span>,num2str(speech_id));
                                [s fs nb]=wavread(st);
                                p=audioplayer(s,fs,nb);
                                play(p);
                            <span class="keyword">end</span>

                            <span class="keyword">if</span> ch3==2
                                [s fs nb]=wavread(<span class="string">'v'</span>);
                                p=audioplayer(s,fs,nb);
                                play(p);
                            <span class="keyword">end</span>
                        <span class="keyword">end</span>

                    <span class="keyword">else</span>
                        warndlg(<span class="string">'Wrong User . No matching Result.'</span>,<span class="string">' Warning '</span>)
                    <span class="keyword">end</span>
                <span class="keyword">else</span>
                    warndlg(<span class="string">'Database is empty. No matching is possible.'</span>,<span class="string">' Warning '</span>)
                <span class="keyword">end</span>
            <span class="keyword">end</span>
            <span class="comment">%----------------------------------------------------------------------</span>
</pre><h2>10.3 Database Info<a name="18"></a></h2><pre class="codeinput">            <span class="keyword">if</span> chos==3

                <span class="keyword">if</span> (exist(<span class="string">'sound_database.dat'</span>,<span class="string">'file'</span>)==2)
                    load(<span class="string">'sound_database.dat'</span>,<span class="string">'-mat'</span>);
                    message=strcat(<span class="string">'Database has #'</span>,num2str(sound_number),<span class="string">'words:'</span>);
                    disp(message);
                    disp(<span class="string">' '</span>);

                    <span class="keyword">for</span> ii=1:sound_number
                        message=strcat(<span class="string">'Location:'</span>,data{ii,3});
                        disp(message);
                        message=strcat(<span class="string">'File:'</span>,data{ii,4});
                        disp(message);
                        message=strcat(<span class="string">'Sound ID:'</span>,num2str(data{ii,2}));
                        disp(message);
                        disp(<span class="string">'-'</span>);
                    <span class="keyword">end</span>

                    ch32=0;
                    <span class="keyword">while</span> ch32 ~=2
                        ch32=menu(<span class="string">'Database Information'</span>,<span class="string">'Database'</span>,<span class="string">'Exit'</span>);

                        <span class="keyword">if</span> ch32==1
                            st=strcat(<span class="string">'Sound Database has : #'</span>,num2str(sound_number),<span class="string">'words. Enter a database number : #'</span>);
                            prompt = {st};
                            dlg_title = <span class="string">'Database Information'</span>;
                            num_lines = 1;
                            def = {<span class="string">'1'</span>};
                            options.Resize=<span class="string">'on'</span>;
                            options.WindowStyle=<span class="string">'normal'</span>;
                            options.Interpreter=<span class="string">'tex'</span>;
                            an = inputdlg(prompt,dlg_title,num_lines,def);
                            an=cell2mat(an);
                            a=str2double(an);

                            <span class="keyword">if</span> (isempty(an))

                            <span class="keyword">else</span>

                                <span class="keyword">if</span> (a &lt;= sound_number)
                                    st=strcat(<span class="string">'u'</span>,num2str(an));
                                    [s fs nb]=wavread(st);
                                    p=audioplayer(s,fs,nb);
                                    play(p);
                                <span class="keyword">else</span>
                                    warndlg(<span class="string">'Invalid Word '</span>,<span class="string">'Warning'</span>);
                                <span class="keyword">end</span>
                            <span class="keyword">end</span>
                        <span class="keyword">end</span>
                    <span class="keyword">end</span>

                <span class="keyword">else</span>
                    warndlg(<span class="string">'Database is empty.'</span>,<span class="string">' Warning '</span>)
                <span class="keyword">end</span>
            <span class="keyword">end</span>
            <span class="comment">%----------------------------------------------------------------------</span>
</pre><h2>10.4 Delete database<a name="19"></a></h2><pre class="codeinput">            <span class="keyword">if</span> chos==4
                <span class="comment">%clc;</span>
                close <span class="string">all</span>;

                <span class="keyword">if</span> (exist(<span class="string">'sound_database.dat'</span>,<span class="string">'file'</span>)==2)
                    button = questdlg(<span class="string">'Do you really want to remove the Database?'</span>);

                    <span class="keyword">if</span> strcmp(button,<span class="string">'Yes'</span>)
                        load(<span class="string">'sound_database.dat'</span>,<span class="string">'-mat'</span>);

                        <span class="keyword">for</span> ii=1:sound_number
                            st=strcat(<span class="string">'u'</span>,num2str(ii),<span class="string">'.wav'</span>);
                            delete(st);
                        <span class="keyword">end</span>

                        <span class="keyword">if</span> (exist(<span class="string">'v.wav'</span>,<span class="string">'file'</span>)==2)
                            delete(<span class="string">'v.wav'</span>);
                        <span class="keyword">end</span>

                        delete(<span class="string">'sound_database.dat'</span>);
                        msgbox(<span class="string">'Database was succesfully removed from the current directory.'</span>,<span class="string">'Database removed'</span>,<span class="string">'help'</span>);
                    <span class="keyword">end</span>

                <span class="keyword">else</span>
                    warndlg(<span class="string">'Database is empty.'</span>,<span class="string">' Warning '</span>)
                <span class="keyword">end</span>
            <span class="keyword">end</span>
        <span class="keyword">end</span>
    <span class="keyword">end</span>

<span class="keyword">end</span>
close <span class="string">all</span>;
msgbox(<span class="string">'Kindly motivate our efforts. Feel free to provide valuable feedback.'</span>,<span class="string">'Thank You'</span>,<span class="string">'help'</span>);
<span class="keyword">end</span>
<span class="comment">%--------------------------------------------------------------------------</span>
</pre><h2>blockFrames Function<a name="20"></a></h2>
         <p>blockFrames: Puts the signal into frames</p>
         <p>Inputs: s contains the signal to analize fs is the sampling rate of the signal m is the distance between the beginnings of
            two frames n is the number of samples per frame
         </p>
         <p>Output: M3 is a matrix containing all the frames</p><pre class="codeinput"><span class="keyword">function</span> M3 = blockFrames(s, fs, m, n)
l = length(s);
nbFrame = floor((l - n) / m) + 1;
<span class="keyword">for</span> i = 1:n
    <span class="keyword">for</span> j = 1:nbFrame
        M(i, j) = s(((j - 1) * m) + i); <span class="comment">%#ok&lt;AGROW&gt;</span>
    <span class="keyword">end</span>
<span class="keyword">end</span>
h = hamming(n);
M2 = diag(h) * M;
<span class="keyword">for</span> i = 1:nbFrame
    M3(:, i) = fft(M2(:, i)); <span class="comment">%#ok&lt;AGROW&gt;</span>
<span class="keyword">end</span>
<span class="keyword">end</span>
<span class="comment">%--------------------------------------------------------------------------</span>
</pre><h2>MFCC Function<a name="21"></a></h2>
         <p>MFCC</p>
         <p>Inputs: s contains the signal to analize fs is the sampling rate of the signal</p>
         <p>Output: r contains the transformed signal</p><pre class="codeinput"><span class="keyword">function</span> r = mfcc(s, fs)
m = 100;
n = 256;
frame=blockFrames(s, fs, m, n);
m = melfb(20, n, fs);
n2 = 1 + floor(n / 2);
z = m * abs(frame(1:n2, :)).^2;
r = dct(log(z));
<span class="keyword">end</span>
<span class="comment">%--------------------------------------------------------------------------</span>
</pre><h2>VQLBG Vector quantization using the Linde-Buzo-Gray algorithm<a name="22"></a></h2>
         <p>VQLBG Vector quantization using the Linde-Buzo-Gray algorithm</p>
         <p>Inputs: d contains training data vectors (one per column) k is number of centroids required</p>
         <p>Output: r contains the result VQ codebook (k columns, one for each  centroids)</p><pre class="codeinput"><span class="keyword">function</span> r = vqlbg(d,k)
e = .01;
r = mean(d, 2);
dpr = 10000;
<span class="keyword">for</span> i = 1:log2(k)
    r = [r*(1+e), r*(1-e)];
    <span class="keyword">while</span> (1 == 1)
        z = disteu(d, r);
        [m,ind] = min(z, [], 2);
        t = 0;
        <span class="keyword">for</span> j = 1:2^i
            r(:, j) = mean(d(:, find(ind == j)), 2); <span class="comment">%#ok&lt;FNDSB&gt;</span>
            x = disteu(d(:, find(ind == j)), r(:, j)); <span class="comment">%#ok&lt;FNDSB&gt;</span>
            <span class="keyword">for</span> q = 1:length(x)
                t = t + x(q);
            <span class="keyword">end</span>
        <span class="keyword">end</span>
        <span class="keyword">if</span> (((dpr - t)/t) &lt; e)
            <span class="keyword">break</span>;
        <span class="keyword">else</span>
            dpr = t;
        <span class="keyword">end</span>
    <span class="keyword">end</span>
<span class="keyword">end</span>
<span class="keyword">end</span>
<span class="comment">%--------------------------------------------------------------------------</span>
</pre><p class="footer"><br>
            Published with MATLAB&reg; 7.5<br></p>
      </div>
      <!--
##### SOURCE BEGIN #####
%% Project: Voice Recognition and Identification system
% By  Mahima Garg, Omar Razi, Supriya Phutela, Vaibhav Kapoor, Varun Chopra
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

%% Main Function Voice Recognition
function []=voicerecognition()
% For clear screen
clc;
% Ronaldo is a variable used to directly set the minimum distance for
% speech recognition.
ronaldo=10;
% Drogba is a variable used to directly set the maximum number of
% users stored in database
drogba=8;
% st, st1, st2, st3,  will be used for filenames related purposes reducing
% code redundancy.
char st; char st1; char st2; char st3;
disp('Project: Voice Recognition and Identification system');
disp('By  Mahima Garg & Omar Razi & Supriya Phutela & Vaibhav Kapoor & Varun Chopra ');
disp(' ');
pause(0.5);
disp('LOADING ');
pause(1);
disp('... ');
pause(1);
disp('... ');
pause(1);
disp('... ');
pause(1);
disp('... ');
msgbox('We have tried to make this project as user friendly as possible. We Hope you Appreciate and Enjoy !!!','Voice Recognition and Identification System');

% Preallocating array
str = {8}; fstr = {8}; nbtr = {8};
ste = {8}; fste = {8}; nbte = {8};
ctr = {8}; dtr={8};
cte = {8}; dte={8};
data = {drogba,4};
code = {8};

for i = 1:8

    % Read audio data from train folder for performing operations
    st=strcat('train\s',num2str(i),'.wav');
    [s1 fs1 nb1]=wavread(st);
    str{i} = s1; fstr{i} = fs1; nbtr{i} = nb1;

    % Read audio data from test folder for performing operations
    st = strcat('test\s',num2str(i),'.wav');
    [st1 fst1 nbt1] = wavread(st);
    ste{i} = st1; fste{i} = fst1; nbte{i} = nbt1;

    % Compute MFCC of the audio data to be used in Speech Processing for Train
    % Folder
    ctr{i} = mfcc(str{i},fstr{i});

    % Compute MFCC of the audio data to be used in Speech Processing for Test
    % Folder
    cte{i} = mfcc(ste{i},fste{i});

    % Compute Vector Quantization of the audio data to be used in Speech
    % Processing for Train Folder
    dtr{i} = vqlbg(ctr{i},16);

    % Compute Vector Quantization of the audio data to be used in Speech
    % Processing for Test Folder
    dte{i} = vqlbg(cte{i},16);
end

% For making Choice
ch=0;
poss=11;
while ch~=poss

    ch=menu('Speaker Recognition System','1: Human speaker recognition',...
        '2: Technical data of samples',...
        '3: Power Spectrum','4: Power Spectrum with different M and N',...
        '5: Mel-Spaced Filter Bank',...
        '6: Spectrum before and after Mel-Frequency wrapping',...
        '7: 2D plot of acoustic vectors',...
        '8: Plot of VQ codewords','9: Recognition rate of the computer',...
        '10: Test with other speech files','11: Exit');
    disp('                                                                  ');
    %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

%% 1: Human speaker recognition
    % Play each sound file in the TRAIN folder. Can you distinguish the voices
    % of those eight speakers? Now play each sound in the TEST folder in a
    % random order without looking at the file name (pretending that you do not
    % know the speaker) and try to identify the speaker using your knowledge of
    % their voices that you just learned from the TRAIN folder. This is exactly
    % what the computer will do in our system.
    % What is your (human performance) recognition rate ?
    % Record this result so that it can be used later to be compared with the
    % computer's performance of our system. Both of us seem to be unable to
    % recognise random people just by listening at their voice. Our success
    % rates for the provided samples were 1 person out of 8 each.
    %
    % However, for the samples we used in question 10, we were easily able to
    % recognise each speaker. This is probably because we knew all the persons.
    % We also realized that we did not identify speakers by the frequencies
    % they use to talk, but rather by other characteristics, like accent,
    % speed, etc.

    if ch==1
        disp('>  1: Human speaker recognition');
        disp('Play each sound file in the TRAIN folder.');
        disp('Can you distinguish the voices of those eight speakers?');
        disp('Now play each sound in the TEST folder in a random order without looking at the file name ');
        disp('and try to identify the speaker using your knowledge of their voices that you have just heard,');
        disp('from the TRAIN folder. This is exactly what the computer will do in our system.');
        disp('                                                                                                  ');
        disp('                                                                                                   ');
        disp('All of us seem to be unable to recognise random people just by listening to their voice. ');
        disp('We also realize that we do not identify speakers by the frequencies with which they use to talk,  ');
        disp('but rather by other characteristics, like accent, speed, etc.');
        pause(1);

        ch2=0;
        while ch2~=4
            ch2=menu('Select Folder','Train','Test','User','Exit');

            if ch2==1

                ch3=0;
                while ch3~=9
                    ch3=menu('Train :','Signal 1','Signal 2','Signal 3',...
                        'Signal 4','Signal 5','Signal 6','Signal 7','Signal 8','Exit');
                    if ch3~=9
                        p=audioplayer(str{ch3},fstr{ch3},nbtr{ch3});
                        play(p);
                    end
                end
            end

            if ch2==2

                ch3=0;
                while ch3~=9
                    ch3=menu('Test :','Signal 1','Signal 2','Signal 3',...
                        'Signal 4','Signal 5','Signal 6','Signal 7','Signal 8','Exit');
                    if ch3~=9
                        p=audioplayer(ste{ch3},fste{ch3},nbte{ch3});
                        play(p);
                    end
                end
                close all;
            end

            if ch2==3

                if (exist('sound_database.dat','file')==2)
                    load('sound_database.dat','-mat');

                    ch32=0;
                    while ch32 ~=2
                        ch32=menu('Database Information','Database','Exit');

                        if ch32==1
                            st=strcat('Sound Database has : #',num2str(sound_number),'words. Enter a database number : #');
                            prompt = {st};
                            dlg_title = 'Database Information';
                            num_lines = 1;
                            def = {'1'};
                            options.Resize='on';
                            options.WindowStyle='normal';
                            options.Interpreter='tex';
                            an = inputdlg(prompt,dlg_title,num_lines,def);
                            an=cell2mat(an);
                            a = str2double(an);

                            if (isempty(an))

                            else

                                if (a <= sound_number)
                                    st=strcat('u',num2str(an));
                                    [s fs nb]=wavread(st);
                                    p=audioplayer(s,fs,nb);
                                    play(p);

                                else
                                    warndlg('Invalid Word ','Warning');
                                end
                            end
                        end
                        close all;
                    end

                else
                    warndlg('Database is empty.',' Warning ')
                end
            end

        end
    end
    %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

%% 2: Technical data of samples
    % Read a sound file into Matlab. Check it by playing the sound file in
    % Matlab using the function: sound. What is the sampling rate? What is the
    % highest frequency that the recorded sound can capture with fidelity? With
    % that sampling rate, how many msecs of actual speech are contained in a
    % block of 256 samples?
    %
    % Plot the signal to view it in the time domain. It should be obvious that
    % the raw data in the time domain has a great amount of data and for this
    % reason it is difficult to analyse the voice characteristic. So the
    % purpose of this step (speech feature extraction) should be clear now!
    %
    % Intermediate steps that follows:
    %
    % Frames blocking phase
    % To obtain a matrix M containing all the frames, we used the following script:
    % That way we obtain the 256 x 129 matrix M.
    %
    % Windowing phase
    % We create the Hamming matrix and transform the matrix M into the new
    % matrix M2, where the column vectors of M2 are the original frame vectors
    % transformed by the Hamming filter.
    %
    % FFT Phase
    % We create a new matrix M3 where the column vectors are the FFTs of the
    % column vectors of M2.

    if ch==2
        disp('> 2: Technical data of samples');

        ch23=0;
        while ch23~=4
            ch23=menu('Select Folder','Train','Test','User','Exit');

            if ch23==1
                poss2=9;
                ch2=0;
                while ch2~=poss2
                    ch2=menu('Technical data of samples for :','Signal 1','Signal 2','Signal 3',...
                        'Signal 4','Signal 5','Signal 6','Signal 7','Signal 8','Exit');
                    if ch2~=9
                        t = 0:1/fstr{ch2}:(length(str{ch2}) - 1)/fstr{ch2};
                        plot(t, str{ch2}), axis([0, (length(str{ch2}) - 1)/fstr{ch2} -0.4 0.5]);
                        st=sprintf('Plot of signal s%d.wav',ch2);
                        title(st);
                        xlabel('Time [s]');
                        ylabel('Amplitude (normalized)')
                    end
                end
                close all
            end

            if ch23==2
                poss2=9;
                ch2=0;
                while ch2~=poss2
                    ch2=menu('Technical data of samples for :','Signal 1','Signal 2','Signal 3',...
                        'Signal 4','Signal 5','Signal 6','Signal 7','Signal 8','Exit');
                    if ch2~=9
                        t = 0:1/fste{ch2}:(length(ste{ch2}) - 1)/fste{ch2};
                        plot(t, ste{ch2}), axis([0, (length(ste{ch2}) - 1)/fste{ch2} -0.4 0.5]);
                        st=sprintf('Plot of signal s%d.wav',ch2);
                        title(st);
                        xlabel('Time [s]');
                        ylabel('Amplitude (normalized)')
                    end
                end
                close all
            end

            if ch23==3

                if (exist('sound_database.dat','file')==2)
                    load('sound_database.dat','-mat');

                    ch32=0;
                    while ch32 ~=2
                        ch32=menu('Database Information','Database','Exit');

                        if ch32==1
                            st=strcat('Sound Database has : #',num2str(sound_number),'words. Enter a database number : #');
                            prompt = {st};
                            dlg_title = 'Database Information';
                            num_lines = 1;
                            def = {'1'};
                            options.Resize='on';
                            options.WindowStyle='normal';
                            options.Interpreter='tex';
                            an = inputdlg(prompt,dlg_title,num_lines,def);
                            an=cell2mat(an);
                            a = str2double(an);

                            if (isempty(an))

                            else

                                if (a <= sound_number)
                                    st=strcat('u',num2str(an));
                                    [s fs]=wavread(st);
                                    t = 0:1/fs:(length(s) - 1)/fs;
                                    plot(t, s), axis([0, (length(s) - 1)/fs -0.4 0.5]);
                                    st=sprintf('Plot of signal %s',st);
                                    title(st);
                                    xlabel('Time [s]');
                                    ylabel('Amplitude (normalized)')

                                else
                                    warndlg('Invalid Word ','Warning');
                                end
                            end

                        end
                    end
                    close all;

                else
                    warndlg('Database is empty.',' Warning ')
                end
            end

        end
    end
    %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

%% 3: linear and logarithmic power spectrum plot
    % After successfully running the preceding process, what is the
    % interpretation you can make of the result obtained? Compute the power
    % spectrum and plot it out using the imagesc command. Note that it is
    % better to view the power spectrum on the log scale. Locate the region in
    % the plot that contains most of the energy. Translate this location into
    % the actual ranges in time (msec) and frequency (in Hz) of the input
    % speech signal.
    %
    % As stated before, the columns matrix M3 contain the frames of the
    % original signal, filtered by the Hamming filter and transformed with the
    % FFT. The elements of M3 are complex numbers and symmetrical because FFT
    % was used to transform the data.
    % Each column in M3 is a power spectrum representation of the original signal.
    % To plot the power spectrum, we take the absolute values of the matrix
    % elements. Since the spectrum is symmetric, we only plot half of it. Note
    % that we plot simultaneously with the linear and the logarithmic spectrum
    % scale.
    %
    % The result obtained is the plot in this section.
    % In this plot, the areas containing the highest level of energy are
    % displayed in red. As we can see on the plot, the red area is located
    % between 0.3 and 0.7 seconds. The plot also shows that most of the energy
    % is concentrated in the lower frequencies (between 50 Hz and 1 kHz).

    if ch==3
        M = 100;
        N = 256;
        disp('> 3: Power Spectrum Plot');
        disp('                                                      ');
        disp('>Linear and Logarithmic spectrum plot');

        ch23=0;
        while ch23~=4
            ch23=menu('Select Folder','Train','Test','User','Exit');

            if ch23==1
                poss3=9;
                ch3=0;
                while ch3~=poss3
                    ch3=menu('Linear and Logarithmic Power Spectrum Plot for : ','Signal 1','Signal 2','Signal 3',...
                        'Signal 4','Signal 5','Signal 6','Signal 7','Signal 8','Exit');
                    if ch3~=9
                        % 3 (linear)
                        frames = blockFrames(str{ch3}, fstr{ch3}, M, N);
                        t = N / 2;
                        tm = length(str{ch3}) / fstr{ch3};
                        subplot(121);
                        imagesc([0 tm], [0 fstr{ch3}/2], abs(frames(1:t, :)).^2), axis xy;
                        title('Power Spectrum (M = 100, N = 256)');
                        xlabel('Time [s]');
                        ylabel('Frequency [Hz]');
                        colorbar;
                        % 3 (logarithmic)
                        subplot(122);
                        imagesc([0 tm], [0 fstr{ch3}/2], 20 * log10(abs(frames(1:t, :)).^2)), axis xy;
                        title('Logarithmic Power Spectrum (M = 100, N = 256)');
                        xlabel('Time [s]');
                        ylabel('Frequency [Hz]');
                        colorbar;
                        % D=get(gcf,'Position');
                        % set(gcf,'Position',round([D(1)*.5 D(2)*.5 D(3)*2 D(4)*1.3]))
                    end
                end
                close all
            end

            if ch23==2
                poss3=9;
                ch3=0;
                while ch3~=poss3
                    ch3=menu('Linear and Logarithmic Power Spectrum Plot for : ','Signal 1','Signal 2','Signal 3',...
                        'Signal 4','Signal 5','Signal 6','Signal 7','Signal 8','Exit');
                    if ch3~=9
                        % 3 (linear)
                        frames = blockFrames(ste{ch3}, fste{ch3}, M, N);
                        t = N / 2;
                        tm = length(ste{ch3}) / fste{ch3};
                        subplot(121);
                        imagesc([0 tm], [0 fste{ch3}/2], abs(frames(1:t, :)).^2), axis xy;
                        title('Power Spectrum (M = 100, N = 256)');
                        xlabel('Time [s]');
                        ylabel('Frequency [Hz]');
                        colorbar;
                        % 3 (logarithmic)
                        subplot(122);
                        imagesc([0 tm], [0 fste{ch3}/2], 20 * log10(abs(frames(1:t, :)).^2)), axis xy;
                        title('Logarithmic Power Spectrum (M = 100, N = 256)');
                        xlabel('Time [s]');
                        ylabel('Frequency [Hz]');
                        colorbar;
                        % D=get(gcf,'Position');
                        % set(gcf,'Position',round([D(1)*.5 D(2)*.5 D(3)*2 D(4)*1.3]))
                    end
                end
                close all;
            end

            if ch23==3

                if (exist('sound_database.dat','file')==2)
                    load('sound_database.dat','-mat');

                    ch32=0;
                    while ch32 ~=2
                        ch32=menu('Database Information','Database','Exit');

                        if ch32==1
                            st=strcat('Sound Database has : #',num2str(sound_number),'words. Enter a database number : #');
                            prompt = {st};
                            dlg_title = 'Database Information';
                            num_lines = 1;
                            def = {'1'};
                            options.Resize='on';
                            options.WindowStyle='normal';
                            options.Interpreter='tex';
                            an = inputdlg(prompt,dlg_title,num_lines,def);
                            an=cell2mat(an);
                            a = str2double(an);

                            if (isempty(an))

                            else

                                if (a <= sound_number)
                                st=strcat('u',num2str(an));
                                [s fs]=wavread(st);
                                frames = blockFrames(s, fs, M, N);
                                t = N / 2;
                                tm = length(s) / fs;
                                subplot(121);
                                imagesc([0 tm], [0 fs/2], abs(frames(1:t, :)).^2), axis xy;
                                title('Power Spectrum (M = 100, N = 256)');
                                xlabel('Time [s]');
                                ylabel('Frequency [Hz]');
                                colorbar;
                                %Question 3 (logarithmic)
                                subplot(122);
                                imagesc([0 tm], [0 fs/2], 20 * log10(abs(frames(1:t, :)).^2)), axis xy;
                                title('Logarithmic Power Spectrum (M = 100, N = 256)');
                                xlabel('Time [s]');
                                ylabel('Frequency [Hz]');
                                colorbar;

                                else
                                    warndlg('Invalid Word ','Warning');
                                end
                            end
                        end
                    end
                    close all;

                else
                    warndlg('Database is empty.',' Warning ')
                end
            end

        end
    end
    %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

%%  4: Plots for different values for N
    % Compute and plot the power spectrum of a speech file using different
    % frames sizes: for example N = 128, 256 and 512. In each case, set the
    % frame increement M to be about N/3. Can you describe and explain the
    % differences between these spectra ?
    %
    % For N = 128 we have a high resolution of time. Furthermore each frame
    % lasts a very short period of time. This result shows that the signal for
    % a frame doesn't change its nature (i.e. it will be for the same vowel or
    % consonant). On the other hand, there are only 65 distinct frequencies
    % samples. This means that we have a poor frequency resolution.
    %
    % For N = 256 we have a compro mise between the resolution in time and the
    % frequency resolution.
    % For N = 512 we have an excellent frequency resolution (256 different
    % values) but there are lesser frames, meaning that the resolution in
    % time is strongly reduced.
    % It seems that a value of 256 for N is an acceptable compromise.
    % Furthermore the number of frames is relatively small, which will reduce
    % computing time.

    if ch==4
        disp('>  4: Plots for different values for M and N');
        lN = [128 256 512];

        ch23=0;
        while ch23~=4
            ch23=menu('Select Folder','Train','Test','User','Exit');

            if ch23==1
                poss3=9;
                ch3=0;
                while ch3~=poss3
                    ch3=menu('Plots for different values of M and N for :','Signal 1','Signal 2','Signal 3',...
                        'Signal 4','Signal 5','Signal 6','Signal 7','Signal 8','Exit');
                    if ch3~=9
                        u=220;
                        for i = 1:length(lN)
                            N = lN(i);
                            M = round(N / 3);
                            frames = blockFrames(str{ch3}, fstr{ch3}, M, N);
                            t = N / 2;
                            tm = length(str{ch3}) / fstr{ch3};
                            temp = size(frames);
                            nbframes = temp(2);
                            u=u+1;
                            subplot(u)
                            imagesc([0 tm], [0 fstr{ch3}/2], 20 * log10(abs(frames(1:t, :)).^2)), axis xy;
                            title(sprintf('Power Spectrum (M = %i, N = %i, frames = %i)', M, N, nbframes));
                            xlabel('Time [s]');
                            ylabel('Frequency [Hz]');
                            colorbar
                        end
                        % D=get(gcf,'Position');
                        % set(gcf,'Position',round([D(1)*.5 D(2)*.5 D(3)*1.5 D(4)*1.5]))
                    end
                end
                close all
            end

            if ch23==2
                poss3=9;
                ch3=0;
                while ch3~=poss3
                    ch3=menu('Plots for different values of M and N for :','Signal 1','Signal 2','Signal 3',...
                        'Signal 4','Signal 5','Signal 6','Signal 7','Signal 8','Exit');
                    if ch3~=9
                        u=220;
                        for i = 1:length(lN)
                            N = lN(i);
                            M = round(N / 3);
                            frames = blockFrames(ste{ch3}, fste{ch3}, M, N);
                            t = N / 2;
                            tm = length(ste{ch3}) / fste{ch3};
                            temp = size(frames);
                            nbframes = temp(2);
                            u=u+1;
                            subplot(u)
                            imagesc([0 tm], [0 fste{ch3}/2], 20 * log10(abs(frames(1:t, :)).^2)), axis xy;
                            title(sprintf('Power Spectrum (M = %i, N = %i, frames = %i)', M, N, nbframes));
                            xlabel('Time [s]');
                            ylabel('Frequency [Hz]');
                            colorbar
                        end
                        % D=get(gcf,'Position');
                        % set(gcf,'Position',round([D(1)*.5 D(2)*.5 D(3)*1.5 D(4)*1.5]))
                    end
                end
                close all;
            end

            if ch23==3

                if (exist('sound_database.dat','file')==2)
                    load('sound_database.dat','-mat');

                    ch32=0;
                    while ch32 ~=2
                        ch32=menu('Database Information','Database','Exit');

                        if ch32==1
                            st=strcat('Sound Database has : #',num2str(sound_number),'words. Enter a database number : #');
                            prompt = {st};
                            dlg_title = 'Database Information';
                            num_lines = 1;
                            def = {'1'};
                            options.Resize='on';
                            options.WindowStyle='normal';
                            options.Interpreter='tex';
                            an = inputdlg(prompt,dlg_title,num_lines,def);
                            an=cell2mat(an);                                    
                            a = str2double(an);

                            if (isempty(an))

                            else

                                if (a <= sound_number)
                                    st=strcat('u',num2str(an));
                                    [s fs]=wavread(st);
                                    u=220;
                                    for i = 1:length(lN)
                                        N = lN(i);
                                        M = round(N / 3);
                                        frames = blockFrames(s, fs, M, N);
                                        t = N / 2;
                                        tm = length(s) / fs;
                                        temp = size(frames);
                                        nbframes = temp(2);
                                        u=u+1;
                                        subplot(u)
                                        imagesc([0 tm], [0 fs/2], 20 * log10(abs(frames(1:t, :)).^2)), axis xy;
                                        title(sprintf('Power Spectrum (M = %i, N = %i, frames = %i)', M, N, nbframes));
                                        xlabel('Time [s]');
                                        ylabel('Frequency [Hz]');
                                        colorbar
                                    end
                                else
                                    warndlg('Invalid Word ','Warning');
                                end
                            end
                        end
                     end
                    close all;

                else
                    warndlg('Database is empty.',' Warning ')
                end
            end
        end
    end
    %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

%%  5: Mel Space
    % Type 'help melfb' at the Matlab prompt for more information about this
    % function. Follow the guidelines to plot out the mel-spaced filter bank.
    % What is the behaviour of this filter bank? Compare it with the
    % theoretical part. To plot this filter bank, we use melfb command.
    % This filter bank behaves like a succession of histograms on the spectrum.
    % Each filter of the filter bank has a triangular frequency response. It
    % quantifies the zone of the frequency spectrum.
    %
    % The filter bank is used to transform the spectrum of a signal into a
    % representation which reflects more closely the behaviour of the human
    % ear. As the human ear (or the associated neurons) favours low frequencies
    % for analysing speech, the filters are denser for the lower frequencies.
    % To mimic the human ear, the filters are linearly distributed for low
    % frequencies (below 1kHz). For higher frequencies (above 1 kHz) the
    % distribution of the filters is logarithmic.
    % However we calculated 20 filters (instead of 12).

    if ch==5
        disp('> 5: Mel Space');
        disp('                                                                 ');
        disp('Mel Space is function of sampling rate and since all signals ');
        disp('are recorded at same sampling rate so they have same Mel Space.');

        ch23=0;
        while ch23~=4
            ch23=menu('Select Folder','Train','Test','User','Exit');

            if ch23==1
                poss3=9;
                ch3=0;
                while ch3~=poss3
                    ch3=menu('Mel Space for :','Signal 1','Signal 2','Signal 3',...
                        'Signal 4','Signal 5','Signal 6','Signal 7','Signal 8','Exit');
                    if ch3~=9
                        plot(linspace(0, (fstr{ch3}/2), 129), (melfb(20, 256, fstr{ch3})));
                        title('Mel-Spaced Filterbank');
                        xlabel('Frequency [Hz]');
                    end
                end
                close all
            end


            if ch23==2
                poss3=9;
                ch3=0;
                while ch3~=poss3
                    ch3=menu('Mel Space for :','Signal 1','Signal 2','Signal 3',...
                        'Signal 4','Signal 5','Signal 6','Signal 7','Signal 8','Exit');
                    if ch3~=9
                        plot(linspace(0, (fste{ch3}/2), 129), (melfb(20, 256, fste{ch3})));
                        title('Mel-Spaced Filterbank');
                        xlabel('Frequency [Hz]');
                    end
                end
                close all;
            end

            if ch23==3

                if (exist('sound_database.dat','file')==2)
                    load('sound_database.dat','-mat');

                    ch32=0;
                    while ch32 ~=2
                        ch32=menu('Database Information','Database','Exit');

                        if ch32==1
                            st=strcat('Sound Database has : #',num2str(sound_number),'words. Enter a database number : #');
                            prompt = {st};
                            dlg_title = 'Database Information';
                            num_lines = 1;
                            def = {'1'};
                            options.Resize='on';
                            options.WindowStyle='normal';
                            options.Interpreter='tex';
                            an = inputdlg(prompt,dlg_title,num_lines,def);
                            an=cell2mat(an);
                            a=str2double(an);
                            
                            if (isempty(an))

                            else

                                if (a <= sound_number)
                                    st=strcat('u',num2str(an));
                                    [s fs]=wavread(st);
                                    plot(linspace(0, (fs/2), 129), (melfb(20, 256, fs)));
                                    title('Mel-Spaced Filterbank');
                                    xlabel('Frequency [Hz]');
                                else
                                    warndlg('Invalid Word ','Warning');
                                end
                            end
                        end
                    end
                    close all;

                else
                    warndlg('Database is empty.',' Warning ')
                end
            end

        end
    end
    %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

%%  6: Modified spectrum
    % Compute and plot the spectrum of a speech file before and after the mel-
    % frequency wrapping step. Describe and explain the impact of the melfb
    % program.
    %
    % As we can see in the first plot, most of the information is contained in
    % the lower frequencies. This information has been extracted and amplified
    % in the second plot. The second plot therefore shows the main
    % characteristics of the speech signal.
    % Note that the transformation produced an acoustic vector of 20 dimensions.

    if ch==6
        disp('> 6: Modified spectrum');
        disp('                                                              ');
        disp('Spectrum before and after Mel-Frequency wrapping');
        M = 100;
        N = 256;
        n2 = 1 + floor(N / 2);

        ch23=0;
        while ch23~=4
            ch23=menu('Select Folder','Train','Test','User','Exit');

            if ch23==1
                poss3=9;
                ch3=0;
                while ch3~=poss3
                    ch3=menu('Mel Space for :','Signal 1','Signal 2','Signal 3',...
                        'Signal 4','Signal 5','Signal 6','Signal 7','Signal 8','Exit');
                    if ch3~=9
                        frames = blockFrames(str{ch3}, fstr{ch3}, M, N);
                        m = melfb(20, N, fstr{ch3});
                        z = m * abs(frames(1:n2, :)).^2;
                        tm = length(str{ch3}) / fstr{ch3};
                        subplot(121)
                        imagesc([0 tm], [0 fstr{ch3}/2], abs(frames(1:n2, :)).^2), axis xy;
                        title('Power Spectrum unmodified');
                        xlabel('Time [s]');
                        ylabel('Frequency [Hz]');
                        colorbar;
                        subplot(122)
                        imagesc([0 tm], [0 20], z), axis xy;
                        title('Power Spectrum modified through Mel Cepstrum filter');
                        xlabel('Time [s]');
                        ylabel('Number of Filter in Filter Bank');
                        % colorbar;D=get(gcf,'Position');
                        % set(gcf,'Position',[0 D(2) D(3)/2 D(4)])
                    end
                end
                close all
            end


            if ch23==2
                poss3=9;
                ch3=0;
                while ch3~=poss3
                    ch3=menu('Mel Space for :','Signal 1','Signal 2','Signal 3',...
                        'Signal 4','Signal 5','Signal 6','Signal 7','Signal 8','Exit');
                    if ch3~=9
                        frames = blockFrames(str{ch3}, fstr{ch3}, M, N);
                        m = melfb(20, N, fstr{ch3});
                        z = m * abs(frames(1:n2, :)).^2;
                        tm = length(str{ch3}) / fstr{ch3};
                        subplot(121)
                        imagesc([0 tm], [0 fstr{ch3}/2], abs(frames(1:n2, :)).^2), axis xy;
                        title('Power Spectrum unmodified');
                        xlabel('Time [s]');
                        ylabel('Frequency [Hz]');
                        colorbar;
                        subplot(122)
                        imagesc([0 tm], [0 20], z), axis xy;
                        title('Power Spectrum modified through Mel Cepstrum filter');
                        xlabel('Time [s]');
                        ylabel('Number of Filter in Filter Bank');
                        % colorbar;D=get(gcf,'Position');
                        % set(gcf,'Position',[0 D(2) D(3)/2 D(4)])
                    end
                end
                close all;
            end

            if ch23==3

                if (exist('sound_database.dat','file')==2)
                    load('sound_database.dat','-mat');

                    ch32=0;
                    while ch32 ~=2
                        ch32=menu('Database Information','Database','Exit');

                        if ch32==1
                            st=strcat('Sound Database has : #',num2str(sound_number),'words. Enter a database number : #');
                            prompt = {st};
                            dlg_title = 'Database Information';
                            num_lines = 1;
                            def = {'1'};
                            options.Resize='on';
                            options.WindowStyle='normal';
                            options.Interpreter='tex';
                            an = inputdlg(prompt,dlg_title,num_lines,def);
                            an=cell2mat(an);                         
                            a=str2double(an);
                            
                            if (isempty(an))

                            else

                                if (a <= sound_number)
                                    st=strcat('u',num2str(an));
                                    [s fs]=wavread(st);
                                    frames = blockFrames(s, fs, M, N);
                                    m = melfb(20, N, fs);
                                    z = m * abs(frames(1:n2, :)).^2;
                                    tm = length(s) / fs;
                                    subplot(121)
                                    imagesc([0 tm], [0 fs/2], abs(frames(1:n2, :)).^2), axis xy;
                                    title('Power Spectrum unmodified');
                                    xlabel('Time [s]');
                                    ylabel('Frequency [Hz]');
                                    colorbar;
                                    subplot(122)
                                    imagesc([0 tm], [0 20], z), axis xy;
                                    title('Power Spectrum modified through Mel Cepstrum filter');
                                    xlabel('Time [s]');
                                    ylabel('Number of Filter in Filter Bank');
                                    colorbar;
                                else
                                    warndlg('Invalid Word ','Warning');
                                end
                            end
                        end
                    end
                    close all;

                else
                    warndlg('Database is empty.',' Warning ')
                end
            end

        end
    end
    %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

%%  7: 2D plot of accustic vectors
    % To inspect the acoustic space (MFCC vectors) we can pick any two
    % dimensions (say the 5th and the 6th) and plot the data points in a 2D
    % plane. Use acoustic vectors of two different speakers and plot data
    % points in two different colours. Do the data regions from the two
    % speakers overlap each other? Are they in clusters?
    %
    % Mostly the two areas overlap. But certain regions seem to be used
    % exclusively by one or the other speaker. This is what will allow us to
    % distinguish the different speakers.
    % The points don't form actual clusters, but there are areas where the
    % density of points is higher.
    % Note: This is only a two dimensional plot. The actual vector
    % contains 20 dimensions.

    if ch==7
        disp('>  7: 2D plot of accustic vectors');

        ch23=0;
        while ch23~=4
            ch23=menu('Select Folder','Train','Test','User','Exit');

            if ch23==1
                poss3=3;
                ch3=0;
                while ch3~=poss3
                    ch3=menu('2D plot of accustic vectors representation : ','1. One Signal',...
                        '2. Two Signal','3. Exit');

                    if ch3==1
                        ch31=0;
                        while ch31~=9
                            ch31=menu('2D plot of accustic vectors for :','Signal 1','Signal 2','Signal 3',...
                                'Signal 4','Signal 5','Signal 6','Signal 7','Signal 8','Exit');
                            if ch31~=9
                                plot(ctr{ch31}(5, :), ctr{ch31}(6, :), 'or');
                                xlabel('5th Dimension');
                                ylabel('6th Dimension');
                                st=sprintf('Signal %d ',ch31);
                                legend(st);
                                title('2D plot of accoustic vectors');
                            end
                        end
                        close all;
                    end

                    if ch3==2
                        ch32=0;
                        while ch32~=8
                            ch32=menu('2D plot of accustic vectors for :','Signal 1 & Signal 2',...
                                'Signal 2 & Signal 3','Signal 3 & Signal 4','Signal 4 & Signal 5',...
                                'Signal 5 & Signal 6','Signal 6 & Signal 7','Signal 7 & Signal 8','Exit');
                            if ch32~=8
                                plot(ctr{ch32}(5, :), ctr{ch32}(6, :), 'or');
                                hold on;
                                plot(ctr{ch32+1}(5, :), ctr{ch32+1}(6, :), 'xb');
                                xlabel('5th Dimension');
                                ylabel('6th Dimension');
                                st=sprintf('Signal %d,',ch32);
                                st1=sprintf('Signal %d', (ch32+1) );
                                legend(st,st1);
                                title('2D plot of accoustic vectors');
                                hold off
                            end
                        end
                    end
                    close all
                end
            end

            if ch23==2
                poss3=3;
                ch3=0;
                while ch3~=poss3
                    ch3=menu('2D plot of accustic vectors representation : ','1. One Signal',...
                        '2. Two Signal','3. Exit');

                    if ch3==1
                        ch31=0;
                        while ch31~=9
                            ch31=menu('2D plot of accustic vectors for :','Signal 1','Signal 2','Signal 3',...
                                'Signal 4','Signal 5','Signal 6','Signal 7','Signal 8','Exit');
                            if ch31~=9
                                plot(cte{ch31}(5, :), cte{ch31}(6, :), 'or');
                                xlabel('5th Dimension');
                                ylabel('6th Dimension');
                                st=sprintf('Signal %d ',ch31);
                                legend(st);
                                title('2D plot of accoustic vectors');
                            end
                        end
                        close all;
                    end

                    if ch3==2
                        ch32=0;
                        while ch32~=8
                            ch32=menu('2D plot of accustic vectors for :','Signal 1 & Signal 2',...
                                'Signal 2 & Signal 3','Signal 3 & Signal 4','Signal 4 & Signal 5',...
                                'Signal 5 & Signal 6','Signal 6 & Signal 7','Signal 7 & Signal 8','Exit');

                            if ch32~=8
                                plot(cte{ch32}(5, :), cte{ch32}(6, :), 'or');
                                hold on;
                                plot(cte{ch32+1}(5, :), cte{ch32+1}(6, :), 'xb');
                                xlabel('5th Dimension');
                                ylabel('6th Dimension');
                                st=sprintf('Signal %d,',ch32);
                                st1=sprintf('Signal %d', (ch32+1) );
                                legend(st,st1);
                                title('2D plot of accoustic vectors');
                                hold off
                            end
                        end
                    end
                    close all
                end
            end

            if ch23==3

                if (exist('sound_database.dat','file')==2)
                    load('sound_database.dat','-mat');

                    ch32=0;
                    while ch32 ~=2
                        ch32=menu('Database Information','Database','Exit');

                        if ch32==1
                            st=strcat('Sound Database has : #',num2str(sound_number),'words. Enter a database number : #');
                            prompt = {st};
                            dlg_title = 'Database Information';
                            num_lines = 1;
                            def = {'1'};
                            options.Resize='on';
                            options.WindowStyle='normal';
                            options.Interpreter='tex';
                            an = inputdlg(prompt,dlg_title,num_lines,def);
                            an=cell2mat(an);
                            a=str2double(an);
                            
                            if (isempty(an))

                            else

                                if (a <= sound_number)
                                    st=strcat('u',num2str(an));
                                    [s fs]=wavread(st);
                                    c = mfcc(s, fs);
                                    plot(c(5, :), c(6, :), 'or');
                                    xlabel('5th Dimension');
                                    ylabel('6th Dimension');
                                    st1=sprintf('Signal %s.wav',st);
                                    legend(st1);
                                    title('2D plot of accoustic vectors');
                                else
                                    warndlg('Invalid Word ','Warning');
                                end
                            end
                        end
                    end
                    close all;

                else
                    warndlg('Database is empty.',' Warning ')
                end
            end

        end
    end
    %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

%%  8: Plot of the 2D trained VQ codewords
    % Plot the data points of the trained VQ codeword using the two dimensions
    % previously used for the plot of the last question.
    % The example in previous figure is an ideal case for teaching. In reality
    % however the clusters cannot be that easily distinguished. But again, this
    % is a two dimensional representation of a 20 dimensions space.

    if ch==8
        disp('>  8: Plot of the 2D trained VQ codewords');

        ch23=0;
        while ch23~=4
            ch23=menu('Select Folder','Train','Test','User','Exit');

            if ch23==1
                poss3=3;
                ch3=0;
                while ch3~=poss3
                    ch3=menu('2D plot of accustic vectors representation : ','1. One Signal',...
                        '2. Two Signal','3. Exit');

                    if ch3==1
                        ch31=0;
                        while ch31~=9
                            ch31=menu('2D plot of accustic vectors for :','Signal 1','Signal 2','Signal 3',...
                                'Signal 4','Signal 5','Signal 6','Signal 7','Signal 8','Exit');

                            if ch31~=9
                                plot(ctr{ch31}(5, :), ctr{ch31}(6, :), 'xr')
                                hold on
                                plot(dtr{ch31}(5, :), dtr{ch31}(6, :), 'vk')
                                xlabel('5th Dimension');
                                ylabel('6th Dimension');
                                st=sprintf('Speaker %d',ch31);
                                st1=sprintf('Codebook %d', (ch31) );
                                legend(st,st1);
                                title('2D plot of accoustic vectors');
                                hold off
                            end
                        end
                        close all
                    end

                    if ch3==2
                        ch32=0;
                        while ch32~=8
                            ch32=menu('2D plot of accustic vectors for :','Signal 1 & Signal 2',...
                                'Signal 2 & Signal 3','Signal 3 & Signal 4','Signal 4 & Signal 5',...
                                'Signal 5 & Signal 6','Signal 6 & Signal 7','Signal 7 & Signal 8','Exit');

                            if ch32~=8
                                plot(ctr{ch32}(5, :), ctr{ch32}(6, :), 'xr')
                                hold on
                                plot(dtr{ch32}(5, :), dtr{ch32}(6, :), 'vk')
                                plot(ctr{ch32+1}(5, :), ctr{ch32+1}(6, :), 'xb')
                                plot(dtr{ch32+1}(5, :), dtr{ch32+1}(6, :), '+k')
                                xlabel('5th Dimension');
                                ylabel('6th Dimension');
                                st=sprintf('Speaker %d',ch32);
                                st1=sprintf('Codebook %d',ch32 );
                                st2=sprintf('Speaker %d',(ch32+1) );
                                st3=sprintf('Codebook %d', (ch32+1) );
                                legend(st,st1,st2,st3);
                                title('2D plot of accoustic vectors');
                                hold off
                            end
                        end
                    end
                    close all
                end
            end

            if ch23==2
                poss3=3;
                ch3=0;
                while ch3~=poss3
                    ch3=menu('2D plot of accustic vectors representation : ','1. One Signal',...
                        '2. Two Signal','3. Exit');

                    if ch3==1
                        ch31=0;
                        while ch31~=9
                            ch31=menu('2D plot of accustic vectors for :','Signal 1','Signal 2','Signal 3',...
                                'Signal 4','Signal 5','Signal 6','Signal 7','Signal 8','Exit');

                            if ch31~=9
                                plot(cte{ch31}(5, :), cte{ch31}(6, :), 'xr')
                                hold on
                                plot(dte{ch31}(5, :), dte{ch31}(6, :), 'vk')
                                xlabel('5th Dimension');
                                ylabel('6th Dimension');
                                st=sprintf('Speaker %d',ch31);
                                st1=sprintf('Codebook %d', (ch31) );
                                legend(st,st1);
                                title('2D plot of accoustic vectors');
                                hold off
                            end
                        end
                        close all
                    end

                    if ch3==2
                        ch32=0;
                        while ch32~=8
                            ch32=menu('2D plot of accustic vectors for :','Signal 1 & Signal 2',...
                                'Signal 2 & Signal 3','Signal 3 & Signal 4','Signal 4 & Signal 5',...
                                'Signal 5 & Signal 6','Signal 6 & Signal 7','Signal 7 & Signal 8','Exit');

                            if ch32~=8
                                plot(cte{ch32}(5, :), cte{ch32}(6, :), 'xr')
                                hold on
                                plot(dte{ch32}(5, :), dte{ch32}(6, :), 'vk')
                                plot(cte{ch32+1}(5, :), cte{ch32+1}(6, :), 'xb')
                                plot(dte{ch32+1}(5, :), dte{ch32+1}(6, :), '+k')
                                xlabel('5th Dimension');
                                ylabel('6th Dimension');
                                st=sprintf('Speaker %d',ch32);
                                st1=sprintf('Codebook %d',ch32 );
                                st2=sprintf('Speaker %d', (ch32+1) );
                                st3=sprintf('Codebook %d', (ch32+1) );
                                legend(st,st1,st2,st3);
                                title('2D plot of accoustic vectors');
                                hold off
                            end
                        end
                    end
                    close all
                end
            end

            if ch23==3

                if (exist('sound_database.dat','file')==2)
                    load('sound_database.dat','-mat');

                    ch32=0;
                    while ch32 ~=2
                        ch32=menu('Database Information','Database','Exit');

                        if ch32==1
                            st=strcat('Sound Database has : #',num2str(sound_number),'words. Enter a database number : #');
                            prompt = {st};
                            dlg_title = 'Database Information';
                            num_lines = 1;
                            def = {'1'};
                            options.Resize='on';
                            options.WindowStyle='normal';
                            options.Interpreter='tex';
                            an = inputdlg(prompt,dlg_title,num_lines,def);
                            an=cell2mat(an);
                            a=str2double(an);
                            
                            if (isempty(an))

                            else

                                if (a <= sound_number)
                                    st=strcat('u',num2str(an));
                                    [s fs]=wavread(st);
                                    c = mfcc(s, fs);
                                    d = vqlbg(c, 16);
                                    plot(c(5, :), c(6, :), 'xr');
                                    hold on
                                    plot(d(5, :), d(6, :), 'vk');
                                    xlabel('5th Dimension');
                                    ylabel('6th Dimension');
                                    st1=sprintf('Speaker %s',st);
                                    st2=sprintf('Codebook %s',st);
                                    legend(st1,st2);
                                    title('2D plot of accoustic vectors');
                                    hold off
                                else
                                    warndlg('Invalid Word ','Warning');
                                end
                            end
                        end
                    end
                    close all;

                else
                    warndlg('Database is empty.',' Warning ')
                end
            end

        end
    end
    %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

%%  9: Recognition rate of the computer
    % What is the recognition rate that our system can perform? Compare this
    % with the human's performances. Observe as well if the system makes errors
    % on the speech samples. If so, re -listen to the speech files and try to
    % come up with some explanations.
    % We used the following commands to test the system:
    %
    % The result is:
    % Our system was able to recognize 8 out of 8 speakers. This is an error
    % rate of 0.00%. The recognition rate of our system is much better than the
    % one of a human's recognition rate However you must be aware that this
    % test is not really representative of the computer's efficiency to
    % recognize voices because we only tested on 8 persons, with only one
    % training session and with only one word.
    %
    % Speaker 1 matches with speaker 1
    % Speaker 2 matches with speaker 2
    % Speaker 3 matches with speaker 3
    % Speaker 4 matches with speaker 4
    % Speaker 5 matches with speaker 5
    % Speaker 6 matches with speaker 6
    % Speaker 7 matches with speaker 7
    % Speaker 8 matches with speaker 8

    if ch==9
        disp('> 9: Recognition rate of the computer')
        %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

%% 9.1 Loading from Test Folder for Comparison
% All 8 samples data values are loaded in file sounddatabase1.dat.

        for sound_number = 1: 8
            if size(ste{sound_number},2)==2
                ste{sound_number}=ste{sound_number}(:,1);
            end
            ste{sound_number} = double( ste{sound_number} );
            data{sound_number,1} = ste{sound_number};
            data{sound_number,2} = sound_number;
            st = sprintf('s%d.wav',sound_number);
            data{sound_number,3} = st;
            data{sound_number,4} = 'Test';
            fs=fste{sound_number}; %#ok<NASGU>
            nb=nbte{sound_number}; %#ok<NASGU>
            if sound_number == 1;
                save('sound_database1.dat','data','sound_number','fs','nb');
            else
                save('sound_database1.dat','data','sound_number','fs','nb','-append');
            end
        end

        disp(' ');
        disp('Sounds From TEST added to database for comparison');
        disp(' ');
        %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

%% 9.2 Comparing one by one data from TRAIN FOLDER
% From Train folder samples are tested one by one to database stored in
% file sounddatabase1.dat 
% And matching result is given on the basis of minimum distortion distance

        disp('Comparing one by one data from TRAIN FOLDER');
        disp(' ');
        load('sound_database1.dat','-mat');

        for classe = 1:8
            st = sprintf('Train\\S%d.wav to be compared',classe);
            disp(st);
            pause(0.5);
            if size(str{classe},2)==2
                str{classe}=str{classe}(:,1);
            end
            str{classe} = double(str{classe});
            %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH- code for speaker recognition REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
            disp('MFCC cofficients computation and VQ codebook training in progress...');
            % Number of centroids required
            k =16;
            for ii=1:sound_number
                % Compute MFCC cofficients for each sound present in database
                v = mfcc(data{ii,1}, fstr{classe});
                % Train VQ codebook
                code{ii} = vqlbg(v, k);
            end
            disp('Completed.');
            disp(' ');
            % Compute MFCC coefficients for input sound
            v = mfcc(str{classe},fstr{classe});
            % Current distance and sound ID initialization
            distmin = Inf;
            k1 = 0;
            for ii=1:sound_number
                d = disteu(v, code{ii});
                dist = sum(min(d,[],2)) / size(d,1);
                if dist < distmin
                    distmin = dist;
                    k1 = ii;
                end
            end
            min_index = k1;
            speech_id = data{min_index,2};
            %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
            disp('Matching sound:');
            disp(' ');
            message=strcat('File:',data{min_index,3});
            disp(message);
            message=strcat('Location:',data{min_index,4});
            disp(message);
            message = strcat('Recognized speaker ID: ',num2str(speech_id));
            disp(message);
            disp(' ');
        end

        disp('                                                             ');
        pause(0.5)
        msgbox('This prototype is 100% efficient in recognising these 8 different stored sounds in TEST and TRAIN folders. ','Success','help');
    end
    %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

%% 9.3 Note: Test with other speech files
    % You can also test the system with your own speech files. Use the Windows
    % program Sound Recorder to record your own voice and your friends' voices
    % Each new speaker needs to pro vide one speech file for training and one
    % for testing. Can the system recognize your voice? Enjoy.
    %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

%% 10: Voice Recognition by letting user enter into database and then compare
    %Voice recognition is the process of automatically recognizing who is
    %speaking on the basis of individual information included in speech waves.
    %
    %This technique makes it possible to use the speaker's voice to verify
    %their identity and control access to services such as voice dialing,
    %telephone shopping, database access services, information
    %services, voice mail, and remote access to computers.
    


    if ch==10
        disp('> 10: Test with other speech files')
        msgbox('P.S. This prototype is for secondary security usage.','NOTE','help');
        pause(2);
        msgbox('Kindly Note this works for the stored databases only. This means that you can add sounds to the database by users and Recognition will be done for the users entered. ','NOTE','help')
        pause(2);

        chos=0;
        possibility=5;
        while chos~=possibility,
            chos=menu('Speaker Recognition System','Add a new sound from microphone',...
                'Speaker recognition from microphone',...
                'Database Info','Delete database','Exit');

            %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

%% 10.1 Add a new sound from microphone

            if chos==1

                if (exist('sound_database.dat','file')==2)
                    load('sound_database.dat','-mat');                   
                    classe = input('Insert a class number (sound ID) that will be used for recognition:');
                    if isempty(classe)
                        classe = sound_number+1;
                        disp( num2str(classe) );
                    end
                    message=('The following parameters will be used during recording:');
                    disp(message);
                    message=strcat('Sampling frequency',num2str(samplingfrequency));
                    disp(message);
                    message=strcat('Bits per sample',num2str(samplingbits));
                    disp(message);
                    durata = input('Insert the duration of the recording (in seconds):');
                    if isempty(durata)
                        durata = 3;
                        disp( num2str(durata) );
                    end
                    micrecorder = audiorecorder(samplingfrequency,samplingbits,1);
                    disp('Now, speak into microphone...');
                    record(micrecorder,durata);
                    
                    while (isrecording(micrecorder)==1)
                        disp('Recording...');
                        pause(0.5);
                    end
                    disp('Recording stopped.');
                    y1 = getaudiodata(micrecorder);
                    y = getaudiodata(micrecorder, 'uint8');

                    if size(y,2)==2
                        y=y(:,1);
                    end
                    y = double(y);
                    sound_number = sound_number+1;
                    data{sound_number,1} = y;
                    data{sound_number,2} = classe;
                    data{sound_number,3} = 'Microphone';
                    data{sound_number,4} = 'Microphone';
                    st=strcat('u',num2str(sound_number));
                    wavwrite(y1,samplingfrequency,samplingbits,st)
                    save('sound_database.dat','data','sound_number','-append');
                    msgbox('Sound added to database','Database result','help');
                    disp('Sound added to database');

                else
                    classe = input('Insert a class number (sound ID) that will be used for recognition:');
                    if isempty(classe)
                        classe = 1;
                        disp( num2str(classe) );
                    end
                    durata = input('Insert the duration of the recording (in seconds):');
                    if isempty(durata)
                        durata = 3;
                        disp( num2str(durata) );
                    end
                    samplingfrequency = input('Insert the sampling frequency (22050 recommended):');
                    if isempty(samplingfrequency )
                        samplingfrequency = 22050;
                        disp( num2str(samplingfrequency) );
                    end
                    samplingbits = input('Insert the number of bits per sample (8 recommended):');
                    if isempty(samplingbits )
                        samplingbits = 8;
                        disp( num2str(samplingbits) );
                    end
                    micrecorder = audiorecorder(samplingfrequency,samplingbits,1);
                    disp('Now, speak into microphone...');
                    record(micrecorder,durata);

                    while (isrecording(micrecorder)==1)
                        disp('Recording...');
                        pause(0.5);
                    end
                    disp('Recording stopped.');
                    y1 = getaudiodata(micrecorder);
                    y = getaudiodata(micrecorder, 'uint8');

                    if size(y,2)==2
                        y=y(:,1);
                    end
                    y = double(y);
                    sound_number = 1;
                    data{sound_number,1} = y;
                    data{sound_number,2} = classe;
                    data{sound_number,3} = 'Microphone';
                    data{sound_number,4} = 'Microphone';
                    st=strcat('u',num2str(sound_number));
                    wavwrite(y1,samplingfrequency,samplingbits,st)
                    save('sound_database.dat','data','sound_number','samplingfrequency','samplingbits');
                    msgbox('Sound added to database','Database result','help');
                    disp('Sound added to database');
                end
            end

            %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

%% 10.2 Voice Recognition from microphone

            if chos==2

                if (exist('sound_database.dat','file')==2)
                    load('sound_database.dat','-mat');
                    Fs = samplingfrequency;
                    durata = input('Insert the duration of the recording (in seconds):');
                    if isempty(durata)
                        durata = 3;
                        disp( num2str(durata) );
                    end
                    micrecorder = audiorecorder(samplingfrequency,samplingbits,1);
                    disp('Now, speak into microphone...');
                    record(micrecorder,durata);

                    while (isrecording(micrecorder)==1)
                        disp('Recording...');
                        pause(0.5);
                    end
                    disp('Recording stopped.');
                    y = getaudiodata(micrecorder);
                    st='v';
                    wavwrite(y,samplingfrequency,samplingbits,st);
                    y = getaudiodata(micrecorder, 'uint8');
                    % if the input sound is not mono

                    if size(y,2)==2
                        y=y(:,1);
                    end
                    y = double(y);
                    %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH- code for speaker recognition REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
                    disp('MFCC cofficients computation and VQ codebook training in progress...');
                    disp(' ');
                    % Number of centroids required
                    k =16;

                    for ii=1:sound_number
                        % Compute MFCC cofficients for each sound present in database
                        v = mfcc(data{ii,1}, Fs);
                        % Train VQ codebook
                        code{ii} = vqlbg(v, k);
                        disp('...');
                    end
                    disp('Completed.');
                    % Compute MFCC coefficients for input sound
                    v = mfcc(y,Fs);
                    % Current distance and sound ID initialization
                    distmin = Inf;
                    k1 = 0;

                    for ii=1:sound_number
                        d = disteu(v, code{ii});
                        dist = sum(min(d,[],2)) / size(d,1);
                        message=strcat('For User #',num2str(ii),' Dist : ',num2str(dist));
                        disp(message);
             
                        if dist < distmin
                            distmin = dist;
                            k1 = ii;
                        end
                    end

                    if distmin < ronaldo
                        min_index = k1;
                        speech_id = data{min_index,2};
                        %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
                        disp('Matching sound:');
                        message=strcat('File:',data{min_index,3});
                        disp(message);
                        message=strcat('Location:',data{min_index,4});
                        disp(message);
                        message = strcat('Recognized speaker ID: ',num2str(speech_id));
                        disp(message);
                        msgbox(message,'Matching result','help');

                        ch3=0;
                        while ch3~=3
                            ch3=menu('Matched result verification:','Recognized Sound','Recorded sound','Exit');

                            if ch3==1
                                st=strcat('u',num2str(speech_id));
                                [s fs nb]=wavread(st);
                                p=audioplayer(s,fs,nb);
                                play(p);
                            end

                            if ch3==2
                                [s fs nb]=wavread('v');
                                p=audioplayer(s,fs,nb);
                                play(p);
                            end
                        end

                    else
                        warndlg('Wrong User . No matching Result.',' Warning ')
                    end
                else
                    warndlg('Database is empty. No matching is possible.',' Warning ')
                end
            end
            %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

%% 10.3 Database Info

            if chos==3

                if (exist('sound_database.dat','file')==2)
                    load('sound_database.dat','-mat');
                    message=strcat('Database has #',num2str(sound_number),'words:');
                    disp(message);
                    disp(' ');

                    for ii=1:sound_number
                        message=strcat('Location:',data{ii,3});
                        disp(message);
                        message=strcat('File:',data{ii,4});
                        disp(message);
                        message=strcat('Sound ID:',num2str(data{ii,2}));
                        disp(message);
                        disp('-');
                    end

                    ch32=0;
                    while ch32 ~=2
                        ch32=menu('Database Information','Database','Exit');

                        if ch32==1
                            st=strcat('Sound Database has : #',num2str(sound_number),'words. Enter a database number : #');
                            prompt = {st};
                            dlg_title = 'Database Information';
                            num_lines = 1;
                            def = {'1'};
                            options.Resize='on';
                            options.WindowStyle='normal';
                            options.Interpreter='tex';
                            an = inputdlg(prompt,dlg_title,num_lines,def);
                            an=cell2mat(an);
                            a=str2double(an);
                            
                            if (isempty(an))

                            else

                                if (a <= sound_number)
                                    st=strcat('u',num2str(an));
                                    [s fs nb]=wavread(st);
                                    p=audioplayer(s,fs,nb);
                                    play(p);
                                else
                                    warndlg('Invalid Word ','Warning');
                                end
                            end
                        end
                    end

                else
                    warndlg('Database is empty.',' Warning ')
                end
            end
            %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

%% 10.4 Delete database

            if chos==4
                %clc;
                close all;

                if (exist('sound_database.dat','file')==2)
                    button = questdlg('Do you really want to remove the Database?');

                    if strcmp(button,'Yes')
                        load('sound_database.dat','-mat');

                        for ii=1:sound_number
                            st=strcat('u',num2str(ii),'.wav');
                            delete(st);
                        end

                        if (exist('v.wav','file')==2)
                            delete('v.wav');
                        end

                        delete('sound_database.dat');
                        msgbox('Database was succesfully removed from the current directory.','Database removed','help');
                    end

                else
                    warndlg('Database is empty.',' Warning ')
                end
            end
        end
    end

end
close all;
msgbox('Kindly motivate our efforts. Feel free to provide valuable feedback.','Thank You','help');
end
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

%% blockFrames Function
% blockFrames: Puts the signal into frames
%
% Inputs: s contains the signal to analize
% fs is the sampling rate of the signal
% m is the distance between the beginnings of two frames
% n is the number of samples per frame
%
% Output: M3 is a matrix containing all the frames

function M3 = blockFrames(s, fs, m, n)
l = length(s);
nbFrame = floor((l - n) / m) + 1;
for i = 1:n
    for j = 1:nbFrame
        M(i, j) = s(((j - 1) * m) + i); %#ok<AGROW>
    end
end
h = hamming(n);
M2 = diag(h) * M;
for i = 1:nbFrame
    M3(:, i) = fft(M2(:, i)); %#ok<AGROW>
end
end
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

%% MFCC Function
% MFCC
%
% Inputs: s contains the signal to analize
% fs is the sampling rate of the signal
%
% Output: r contains the transformed signal

function r = mfcc(s, fs)
m = 100;
n = 256;
frame=blockFrames(s, fs, m, n);
m = melfb(20, n, fs);
n2 = 1 + floor(n / 2);
z = m * abs(frame(1:n2, :)).^2;
r = dct(log(z));
end
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

%% VQLBG Vector quantization using the Linde-Buzo-Gray algorithm
% VQLBG Vector quantization using the Linde-Buzo-Gray algorithm
%
% Inputs: d contains training data vectors (one per column)
% k is number of centroids required
%
% Output: r contains the result VQ codebook (k columns, one for each  centroids)

function r = vqlbg(d,k)
e = .01;
r = mean(d, 2);
dpr = 10000;
for i = 1:log2(k)
    r = [r*(1+e), r*(1-e)];
    while (1 == 1)
        z = disteu(d, r);
        [m,ind] = min(z, [], 2);
        t = 0;
        for j = 1:2^i
            r(:, j) = mean(d(:, find(ind == j)), 2); %#ok<FNDSB>
            x = disteu(d(:, find(ind == j)), r(:, j)); %#ok<FNDSB>
            for q = 1:length(x)
                t = t + x(q);
            end
        end
        if (((dpr - t)/t) < e)
            break;
        else
            dpr = t;
        end
    end
end
end
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
##### SOURCE END #####
-->
   </body>
</html>